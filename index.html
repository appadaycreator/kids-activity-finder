<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ Pro - ãŠå­æ§˜ã«ã´ã£ãŸã‚Šã®ç¿’ã„äº‹ã‚’è¦‹ã¤ã‘ã‚ˆã†</title>
    <meta name="description" content="æ€§æ ¼ã¨èˆˆå‘³ã‹ã‚‰æœ€é©ãªç¿’ã„äº‹ã‚’è¨ºæ–­ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã€è‹±ä¼šè©±ã€ã‚¹ãƒãƒ¼ãƒ„ã€éŸ³æ¥½ãªã©å¹…åºƒãã‚µãƒãƒ¼ãƒˆ">
    <meta name="keywords" content="å­ä¾›, ç¿’ã„äº‹, è¨ºæ–­, æ•™è‚², ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°, è‹±ä¼šè©±, ã‚¹ãƒãƒ¼ãƒ„, éŸ³æ¥½">
    
    <!-- OGP Tags -->
    <meta property="og:title" content="å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ Pro - ãŠå­æ§˜ã«ã´ã£ãŸã‚Šã®ç¿’ã„äº‹ã‚’è¦‹ã¤ã‘ã‚ˆã†">
    <meta property="og:description" content="æ€§æ ¼ã¨èˆˆå‘³ã‹ã‚‰æœ€é©ãªç¿’ã„äº‹ã‚’è¨ºæ–­ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã€è‹±ä¼šè©±ã€ã‚¹ãƒãƒ¼ãƒ„ã€éŸ³æ¥½ãªã©å¹…åºƒãã‚µãƒãƒ¼ãƒˆ">
    <meta property="og:image" content="https://cdn1.genspark.ai/user-upload-image/22_generated/1b2b567c-0e98-49ba-9ed5-13daec7598d5">
    <meta property="og:url" content="https://appadaycreator.github.io/kids-activity-finder-pro/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ Pro">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ Pro">
    <meta name="twitter:description" content="æ€§æ ¼ã¨èˆˆå‘³ã‹ã‚‰æœ€é©ãªç¿’ã„äº‹ã‚’è¨ºæ–­">
    <meta name="twitter:image" content="https://cdn1.genspark.ai/user-upload-image/22_generated/1b2b567c-0e98-49ba-9ed5-13daec7598d5">
    <meta name="twitter:site" content="@appadaycreator">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¯</text></svg>">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json,{&quot;name&quot;:&quot;å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ Pro&quot;,&quot;short_name&quot;:&quot;ç¿’ã„äº‹è¨ºæ–­&quot;,&quot;start_url&quot;:&quot;/&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;background_color&quot;:&quot;#fff5f5&quot;,&quot;theme_color&quot;:&quot;#ff6b9d&quot;,&quot;icons&quot;:[{&quot;src&quot;:&quot;data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¯</text></svg>&quot;,&quot;sizes&quot;:&quot;192x192&quot;,&quot;type&quot;:&quot;image/svg+xml&quot;}]}">
    
    <!-- External Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Fredoka+One:wght@400&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TXQGZRF9');</script>
    
    <style>
        :root {
            /* Color Palette - Kid-friendly but professional */
            --primary-50: #fef2f2;
            --primary-100: #fee2e2;
            --primary-200: #fecaca;
            --primary-300: #fca5a5;
            --primary-400: #f87171;
            --primary-500: #ef4444;
            --primary-600: #dc2626;
            --primary-700: #b91c1c;
            --primary-800: #991b1b;
            --primary-900: #7f1d1d;
            
            --accent-50: #f0f9ff;
            --accent-100: #e0f2fe;
            --accent-200: #bae6fd;
            --accent-300: #7dd3fc;
            --accent-400: #38bdf8;
            --accent-500: #0ea5e9;
            --accent-600: #0284c7;
            --accent-700: #0369a1;
            --accent-800: #075985;
            --accent-900: #0c4a6e;
            
            --success-50: #f0fdf4;
            --success-500: #22c55e;
            --warning-50: #fffbeb;
            --warning-500: #f59e0b;
            --error-50: #fef2f2;
            --error-500: #ef4444;
            
            /* Typography */
            --font-primary: 'Noto Sans JP', sans-serif;
            --font-heading: 'Fredoka One', cursive;
            
            /* Spacing */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            
            /* Animations */
            --transition-fast: 150ms ease;
            --transition-normal: 250ms ease;
            --transition-slow: 350ms ease;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-primary);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--accent-50) 100%);
            min-height: 100vh;
        }
        
        /* Custom Components */
        .card {
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            padding: var(--space-xl);
            margin: var(--space-md);
            transition: all var(--transition-normal);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-lg);
            font-weight: 500;
            text-decoration: none;
            transition: all var(--transition-normal);
            cursor: pointer;
            border: none;
            font-size: 1rem;
            min-height: 44px; /* Touch target */
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-700) 100%);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary-600);
            border: 2px solid var(--primary-200);
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: var(--primary-50);
            border-color: var(--primary-300);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--primary-100);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin: var(--space-lg) 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-500) 0%, var(--accent-500) 100%);
            border-radius: var(--radius-sm);
            transition: width var(--transition-slow);
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: var(--space-lg);
        }
        
        .form-label {
            display: block;
            margin-bottom: var(--space-sm);
            font-weight: 500;
            color: var(--primary-700);
        }
        
        .form-input {
            width: 100%;
            padding: var(--space-md);
            border: 2px solid var(--primary-200);
            border-radius: var(--radius-md);
            font-size: 1rem;
            transition: all var(--transition-fast);
            background: white;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .form-input.error {
            border-color: var(--error-500);
        }
        
        .error-message {
            color: var(--error-500);
            font-size: 0.875rem;
            margin-top: var(--space-xs);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }
        
        /* Radio Group */
        .radio-group {
            display: grid;
            gap: var(--space-md);
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }
        
        .radio-option {
            position: relative;
            cursor: pointer;
        }
        
        .radio-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .radio-card {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-lg);
            border: 2px solid var(--primary-200);
            border-radius: var(--radius-lg);
            background: white;
            transition: all var(--transition-normal);
            min-height: 80px;
        }
        
        .radio-option input[type="radio"]:checked + .radio-card {
            border-color: var(--primary-500);
            background: var(--primary-50);
            transform: scale(1.02);
            box-shadow: var(--shadow-md);
        }
        
        .radio-card:hover {
            border-color: var(--primary-300);
            background: var(--primary-25);
        }
        
        .radio-icon {
            font-size: 2rem;
            color: var(--primary-500);
            width: 60px;
            text-align: center;
        }
        
        .radio-content h3 {
            margin: 0 0 var(--space-xs) 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-700);
        }
        
        .radio-content p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--primary-600);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0, -30px, 0); }
            70% { transform: translate3d(0, -15px, 0); }
            90% { transform: translate3d(0, -4px, 0); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        .slide-in {
            animation: slideIn 0.4s ease-out;
        }
        
        /* Loading Spinner */
        .spinner {
            border: 3px solid var(--primary-200);
            border-top: 3px solid var(--primary-500);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Result Cards */
        .result-card {
            background: linear-gradient(135deg, white 0%, var(--primary-25) 100%);
            border: 2px solid var(--primary-200);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin: var(--space-lg) 0;
            position: relative;
            overflow: hidden;
        }
        
        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-500) 0%, var(--accent-500) 100%);
        }
        
        .result-rank {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
            color: white;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .card {
                margin: var(--space-sm);
                padding: var(--space-lg);
            }
            
            .radio-group {
                grid-template-columns: 1fr;
            }
            
            .radio-card {
                padding: var(--space-md);
            }
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Focus visible for keyboard navigation */
        .btn:focus-visible,
        .form-input:focus-visible {
            outline: 2px solid var(--primary-500);
            outline-offset: 2px;
        }
        
        /* Print Styles */
        @media print {
            .no-print { display: none !important; }
            .card { box-shadow: none; border: 1px solid #ccc; }
            body { background: white; }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1a1a1a;
                --text-primary: #ffffff;
                --text-secondary: #d1d5db;
            }
        }
        
        /* High contrast mode */
        @media (prefers-contrast: high) {
            .card {
                border: 2px solid var(--primary-600);
            }
            
            .btn-primary {
                background: var(--primary-700);
            }
        }
        
        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXQGZRF9"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
    <div id="app" class="min-h-screen">
        <!-- Header -->
        <header class="bg-white shadow-md sticky top-0 z-50">
            <div class="max-w-4xl mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="text-3xl">ğŸ¯</div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-800" style="font-family: var(--font-heading)">
                                å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ Pro
                            </h1>
                            <p class="text-sm text-gray-600">ãŠå­æ§˜ã«ã´ã£ãŸã‚Šã®ç¿’ã„äº‹ã‚’è¦‹ã¤ã‘ã‚ˆã†</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 no-print">
                        <button id="historyBtn" class="btn btn-secondary text-sm" aria-label="è¨ºæ–­å±¥æ­´ã‚’è¡¨ç¤º">
                            <i class="fas fa-history"></i>
                            å±¥æ­´
                        </button>
                        <button id="settingsBtn" class="btn btn-secondary text-sm" aria-label="è¨­å®šã‚’é–‹ã">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Progress Bar -->
        <div id="progressContainer" class="max-w-4xl mx-auto px-4 py-2" style="display: none;">
            <div class="flex items-center gap-4">
                <span class="text-sm font-medium text-gray-600">é€²æ—</span>
                <div class="flex-1">
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
                <span id="progressText" class="text-sm font-medium text-gray-600">0/6</span>
            </div>
        </div>
        
        <!-- Main Content -->
        <main class="max-w-4xl mx-auto px-4 py-8">
            <!-- Welcome Screen -->
            <div id="welcomeScreen" class="card fade-in text-center">
                <div class="mb-8">
                    <img src="https://cdn1.genspark.ai/user-upload-image/22_generated/1b2b567c-0e98-49ba-9ed5-13daec7598d5" 
                         alt="å­ä¾›ã®ç¿’ã„äº‹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸" 
                         class="w-full max-w-md mx-auto rounded-xl shadow-lg mb-6">
                </div>
                
                <h2 class="text-3xl font-bold mb-4 text-gray-800" style="font-family: var(--font-heading)">
                    ãŠå­æ§˜ã®å¯èƒ½æ€§ã‚’ç™ºè¦‹ã—ã‚ˆã†ï¼
                </h2>
                
                <p class="text-lg text-gray-600 mb-8 max-w-2xl mx-auto">
                    æ€§æ ¼åˆ†æã¨é©æ€§è¨ºæ–­ã§ã€ãŠå­æ§˜ã«ã´ã£ãŸã‚Šã®ç¿’ã„äº‹ã‚’ã”ææ¡ˆã—ã¾ã™ã€‚
                    ç§‘å­¦çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã€ãŠå­æ§˜ã®éš ã‚ŒãŸæ‰èƒ½ã‚’è¦‹ã¤ã‘ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ
                </p>
                
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="text-center">
                        <div class="text-4xl mb-3">ğŸ§ </div>
                        <h3 class="font-semibold mb-2">æ€§æ ¼åˆ†æ</h3>
                        <p class="text-sm text-gray-600">ãŠå­æ§˜ã®æ€§æ ¼ã‚¿ã‚¤ãƒ—ã‚’è©³ã—ãåˆ†æ</p>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">ğŸ¯</div>
                        <h3 class="font-semibold mb-2">é©æ€§ãƒãƒƒãƒãƒ³ã‚°</h3>
                        <p class="text-sm text-gray-600">èˆˆå‘³ã¨èƒ½åŠ›ã«æœ€é©ãªç¿’ã„äº‹ã‚’ææ¡ˆ</p>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">ğŸ“Š</div>
                        <h3 class="font-semibold mb-2">è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ</h3>
                        <p class="text-sm text-gray-600">å…·ä½“çš„ãªç†ç”±ã¨æ•™å®¤æƒ…å ±ã‚’ãŠå±Šã‘</p>
                    </div>
                </div>
                
                <button id="startBtn" class="btn btn-primary text-lg px-8 py-4">
                    <i class="fas fa-play"></i>
                    è¨ºæ–­ã‚’å§‹ã‚ã‚‹ï¼ˆç„¡æ–™ï¼‰
                </button>
                
                <p class="text-xs text-gray-500 mt-4">
                    æ‰€è¦æ™‚é–“ï¼šç´„3åˆ† | è¨ºæ–­çµæœã¯ä¿å­˜ã•ã‚Œã¾ã™
                </p>
            </div>
            
            <!-- Diagnostic Steps -->
            <div id="stepContainer" style="display: none;">
                <!-- Step 1: Basic Info -->
                <div id="step1" class="card fade-in step-content">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-user-circle text-blue-500 mr-3"></i>
                        åŸºæœ¬æƒ…å ±ã‚’ãŠèã‹ã›ãã ã•ã„
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="form-group">
                            <label for="childName" class="form-label">
                                <i class="fas fa-child mr-2"></i>ãŠå­æ§˜ã®ãŠåå‰
                            </label>
                            <input type="text" id="childName" class="form-input" 
                                   placeholder="ä¾‹ï¼šç”°ä¸­ å¤ªéƒ" aria-describedby="childName-error">
                            <div id="childName-error" class="error-message" style="display: none;">
                                <i class="fas fa-exclamation-triangle"></i>
                                ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="childAge" class="form-label">
                                <i class="fas fa-birthday-cake mr-2"></i>å¹´é½¢
                            </label>
                            <select id="childAge" class="form-input" aria-describedby="childAge-error">
                                <option value="">å¹´é½¢ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="3">3æ­³</option>
                                <option value="4">4æ­³</option>
                                <option value="5">5æ­³</option>
                                <option value="6">6æ­³</option>
                                <option value="7">7æ­³</option>
                                <option value="8">8æ­³</option>
                                <option value="9">9æ­³</option>
                                <option value="10">10æ­³</option>
                                <option value="11">11æ­³</option>
                                <option value="12">12æ­³</option>
                                <option value="13">13æ­³</option>
                                <option value="14">14æ­³</option>
                                <option value="15">15æ­³</option>
                            </select>
                            <div id="childAge-error" class="error-message" style="display: none;">
                                <i class="fas fa-exclamation-triangle"></i>
                                å¹´é½¢ã‚’é¸æŠã—ã¦ãã ã•ã„
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="gender" class="form-label">
                                <i class="fas fa-venus-mars mr-2"></i>æ€§åˆ¥
                            </label>
                            <select id="gender" class="form-input">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="boy">ç”·ã®å­</option>
                                <option value="girl">å¥³ã®å­</option>
                                <option value="other">ãã®ä»–ãƒ»ç­”ãˆãŸããªã„</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="budget" class="form-label">
                                <i class="fas fa-yen-sign mr-2"></i>æœˆè¬ã®äºˆç®—
                            </label>
                            <select id="budget" class="form-input" aria-describedby="budget-error">
                                <option value="">äºˆç®—ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="5000">ã€œ5,000å††</option>
                                <option value="10000">5,001ã€œ10,000å††</option>
                                <option value="15000">10,001ã€œ15,000å††</option>
                                <option value="20000">15,001ã€œ20,000å††</option>
                                <option value="25000">20,001ã€œ25,000å††</option>
                                <option value="30000">25,001å††ã€œ</option>
                            </select>
                            <div id="budget-error" class="error-message" style="display: none;">
                                <i class="fas fa-exclamation-triangle"></i>
                                äºˆç®—ã‚’é¸æŠã—ã¦ãã ã•ã„
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end mt-8">
                        <button id="step1Next" class="btn btn-primary" disabled>
                            æ¬¡ã¸é€²ã‚€
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 2: Personality Type -->
                <div id="step2" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-brain text-purple-500 mr-3"></i>
                        æ€§æ ¼ã‚¿ã‚¤ãƒ—è¨ºæ–­
                    </h2>
                    
                    <p class="text-gray-600 mb-8">
                        ãŠå­æ§˜ã®æ€§æ ¼ã«æœ€ã‚‚è¿‘ã„ã‚‚ã®ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚è¤‡æ•°å½“ã¦ã¯ã¾ã‚‹å ´åˆã¯ã€ã‚ˆã‚Šå¼·ãæ„Ÿã˜ã‚‹ã‚‚ã®ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
                    </p>
                    
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="personality" value="active">
                            <div class="radio-card">
                                <div class="radio-icon">âš¡</div>
                                <div class="radio-content">
                                    <h3>ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ã‚¤ãƒ—</h3>
                                    <p>å…ƒæ°—ã„ã£ã±ã„ã€ä½“ã‚’å‹•ã‹ã™ã®ãŒå¤§å¥½ã</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="creative">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ¨</div>
                                <div class="radio-content">
                                    <h3>ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã‚¿ã‚¤ãƒ—</h3>
                                    <p>æƒ³åƒåŠ›è±Šã‹ã€è‡ªç”±ãªè¡¨ç¾ã‚’å¥½ã‚€</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="logical">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ§®</div>
                                <div class="radio-content">
                                    <h3>ãƒ­ã‚¸ã‚«ãƒ«ã‚¿ã‚¤ãƒ—</h3>
                                    <p>è«–ç†çš„æ€è€ƒã€å•é¡Œè§£æ±ºãŒå¾—æ„</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="social">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ‘¥</div>
                                <div class="radio-content">
                                    <h3>ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚¿ã‚¤ãƒ—</h3>
                                    <p>ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èƒ½åŠ›ãŒé«˜ã„</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="calm">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸŒ¸</div>
                                <div class="radio-content">
                                    <h3>ç©ã‚„ã‹ã‚¿ã‚¤ãƒ—</h3>
                                    <p>è½ã¡ç€ã„ã¦ã„ã‚‹ã€é›†ä¸­åŠ›ãŒé«˜ã„</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="adventurous">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ—ºï¸</div>
                                <div class="radio-content">
                                    <h3>å†’é™ºã‚¿ã‚¤ãƒ—</h3>
                                    <p>æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã™ã‚‹ã®ãŒå¥½ã</p>
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step2Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            æˆ»ã‚‹
                        </button>
                        <button id="step2Next" class="btn btn-primary" disabled>
                            æ¬¡ã¸é€²ã‚€
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 3: Interests -->
                <div id="step3" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-heart text-red-500 mr-3"></i>
                        èˆˆå‘³ãƒ»é–¢å¿ƒåˆ†é‡
                    </h2>
                    
                    <p class="text-gray-600 mb-8">
                        ãŠå­æ§˜ãŒèˆˆå‘³ã‚’ç¤ºã—ã¦ã„ã‚‹åˆ†é‡ã‚’é¸ã‚“ã§ãã ã•ã„ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰
                    </p>
                    
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4" id="interestsContainer">
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="sports">
                            <div class="radio-card">
                                <div class="radio-icon">âš½</div>
                                <div class="radio-content">
                                    <h3>ã‚¹ãƒãƒ¼ãƒ„</h3>
                                    <p>ã‚µãƒƒã‚«ãƒ¼ã€é‡çƒã€æ°´æ³³ãªã©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="music">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸµ</div>
                                <div class="radio-content">
                                    <h3>éŸ³æ¥½</h3>
                                    <p>ãƒ”ã‚¢ãƒã€ãƒã‚¤ã‚ªãƒªãƒ³ã€æ­Œãªã©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="art">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ¨</div>
                                <div class="radio-content">
                                    <h3>ã‚¢ãƒ¼ãƒˆ</h3>
                                    <p>çµµç”»ã€å·¥ä½œã€ãƒ‡ã‚¶ã‚¤ãƒ³ãªã©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="language">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ—£ï¸</div>
                                <div class="radio-content">
                                    <h3>è¨€èª</h3>
                                    <p>è‹±èªã€ä¸­å›½èªã€å›½èªãªã©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="science">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ”¬</div>
                                <div class="radio-content">
                                    <h3>ç§‘å­¦ãƒ»ç†æ•°</h3>
                                    <p>å®Ÿé¨“ã€æ•°å­¦ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãªã©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="dance">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ’ƒ</div>
                                <div class="radio-content">
                                    <h3>ãƒ€ãƒ³ã‚¹</h3>
                                    <p>ãƒãƒ¬ã‚¨ã€ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—ã€æ—¥èˆãªã©</p>
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step3Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            æˆ»ã‚‹
                        </button>
                        <button id="step3Next" class="btn btn-primary" disabled>
                            æ¬¡ã¸é€²ã‚€
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 4: Physical Activity Level -->
                <div id="step4" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-running text-green-500 mr-3"></i>
                        ä½“åŠ›ãƒ»é‹å‹•ãƒ¬ãƒ™ãƒ«
                    </h2>
                    
                    <p class="text-gray-600 mb-8">
                        ãŠå­æ§˜ã®ä½“åŠ›ã‚„é‹å‹•ã«å¯¾ã™ã‚‹å§¿å‹¢ã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„
                    </p>
                    
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="activityLevel" value="high">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸƒâ€â™‚ï¸</div>
                                <div class="radio-content">
                                    <h3>ã¨ã¦ã‚‚æ´»ç™º</h3>
                                    <p>ä½“åŠ›ãŒã‚ã‚Šã€æ¿€ã—ã„é‹å‹•ã‚‚å¥½ã‚€</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="activityLevel" value="medium">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸš¶â€â™‚ï¸</div>
                                <div class="radio-content">
                                    <h3>é©åº¦ã«æ´»ç™º</h3>
                                    <p>é‹å‹•ã¯å¥½ãã ãŒã€ç¨‹ã‚ˆã„ãƒ¬ãƒ™ãƒ«</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="activityLevel" value="low">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ“š</div>
                                <div class="radio-content">
                                    <h3>ã‚¤ãƒ³ãƒ‰ã‚¢æ´¾</h3>
                                    <p>å®¤å†…ã§ã®æ´»å‹•ã‚’å¥½ã‚€</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="activityLevel" value="mixed">
                            <div class="radio-card">
                                <div class="radio-icon">âš–ï¸</div>
                                <div class="radio-content">
                                    <h3>ãƒãƒ©ãƒ³ã‚¹å‹</h3>
                                    <p>é‹å‹•ã‚‚å‹‰å¼·ã‚‚ãƒãƒ©ãƒ³ã‚¹ã‚ˆã</p>
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step4Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            æˆ»ã‚‹
                        </button>
                        <button id="step4Next" class="btn btn-primary" disabled>
                            æ¬¡ã¸é€²ã‚€
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 5: Practical Considerations -->
                <div id="step5" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-car text-blue-500 mr-3"></i>
                        å®Ÿç”¨çš„ãªæ¡ä»¶
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-map-marker-alt mr-2"></i>é€è¿ã«ã¤ã„ã¦
                            </label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="transportation" value="easy">
                                    <div class="radio-card">
                                        <div class="radio-icon">ğŸš—</div>
                                        <div class="radio-content">
                                            <h3>é€è¿å¯èƒ½</h3>
                                            <p>è»Šã‚„å…¬å…±äº¤é€šæ©Ÿé–¢ã§é€šãˆã‚‹</p>
                                        </div>
                                    </div>
                                </label>
                                
                                <label class="radio-option">
                                    <input type="radio" name="transportation" value="limited">
                                    <div class="radio-card">
                                        <div class="radio-icon">ğŸšŒ</div>
                                        <div class="radio-content">
                                            <h3>æ¡ä»¶ä»˜ã</h3>
                                            <p>æ™‚é–“ã‚„å ´æ‰€ã«åˆ¶é™ãŒã‚ã‚‹</p>
                                        </div>
                                    </div>
                                </label>
                                
                                <label class="radio-option">
                                    <input type="radio" name="transportation" value="difficult">
                                    <div class="radio-card">
                                        <div class="radio-icon">ğŸ </div>
                                        <div class="radio-content">
                                            <h3>è‡ªå®…è¿‘ãã®ã¿</h3>
                                            <p>å¾’æ­©åœå†…ã¾ãŸã¯ã‚ªãƒ³ãƒ©ã‚¤ãƒ³</p>
                                        </div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-clock mr-2"></i>å¸Œæœ›ã™ã‚‹æ™‚é–“å¸¯
                            </label>
                            <div class="space-y-2">
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="timeSlots" value="weekday_morning">
                                    <span>å¹³æ—¥åˆå‰</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="timeSlots" value="weekday_afternoon">
                                    <span>å¹³æ—¥åˆå¾Œ</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="timeSlots" value="weekday_evening">
                                    <span>å¹³æ—¥å¤•æ–¹</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="timeSlots" value="weekend">
                                    <span>åœŸæ—¥ç¥æ—¥</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step5Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            æˆ»ã‚‹
                        </button>
                        <button id="step5Next" class="btn btn-primary" disabled>
                            æ¬¡ã¸é€²ã‚€
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 6: Goals -->
                <div id="step6" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-target text-yellow-500 mr-3"></i>
                        ç¿’ã„äº‹ã¸ã®æœŸå¾…ãƒ»ç›®æ¨™
                    </h2>
                    
                    <p class="text-gray-600 mb-8">
                        ç¿’ã„äº‹ã‚’é€šã˜ã¦ã€ãŠå­æ§˜ã«ã©ã®ã‚ˆã†ãªæˆé•·ã‚’æœŸå¾…ã—ã¾ã™ã‹ï¼Ÿï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰
                    </p>
                    
                    <div class="grid md:grid-cols-2 gap-4" id="goalsContainer">
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="skill_development">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ¯</div>
                                <div class="radio-content">
                                    <h3>æŠ€è¡“ç¿’å¾—</h3>
                                    <p>å°‚é–€çš„ãªã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¦ã»ã—ã„</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="social_skills">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ‘«</div>
                                <div class="radio-content">
                                    <h3>ç¤¾ä¼šæ€§å‘ä¸Š</h3>
                                    <p>å‹é”ã¨ã®é–¢ã‚ã‚Šã‚„ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="confidence">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ’ª</div>
                                <div class="radio-content">
                                    <h3>è‡ªä¿¡ã®å‘ä¸Š</h3>
                                    <p>é”æˆæ„Ÿã‚’é€šã˜ã¦è‡ªä¿¡ã‚’ã¤ã‘ã¦ã»ã—ã„</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="creativity">
                            <div class="radio-card">
                                <div class="radio-icon">âœ¨</div>
                                <div class="radio-content">
                                    <h3>å‰µé€ æ€§ã®ç™ºé”</h3>
                                    <p>æƒ³åƒåŠ›ã‚„è¡¨ç¾åŠ›ã‚’ä¼¸ã°ã—ãŸã„</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="discipline">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ“</div>
                                <div class="radio-content">
                                    <h3>è¦å¾‹ãƒ»é›†ä¸­åŠ›</h3>
                                    <p>ç¶™ç¶šã™ã‚‹åŠ›ã‚„é›†ä¸­åŠ›ã‚’èº«ã«ã¤ã‘ãŸã„</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="fun">
                            <div class="radio-card">
                                <div class="radio-icon">ğŸ˜Š</div>
                                <div class="radio-content">
                                    <h3>æ¥½ã—ã„æ™‚é–“</h3>
                                    <p>ã¾ãšã¯æ¥½ã—ãéã”ã—ã¦ã»ã—ã„</p>
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step6Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            æˆ»ã‚‹
                        </button>
                        <button id="step6Submit" class="btn btn-primary" disabled>
                            <i class="fas fa-calculator"></i>
                            è¨ºæ–­çµæœã‚’è¦‹ã‚‹
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Loading Screen -->
            <div id="loadingScreen" class="card text-center" style="display: none;">
                <div class="spinner mb-4"></div>
                <h2 class="text-xl font-semibold mb-2">è¨ºæ–­çµæœã‚’åˆ†æã—ã¦ã„ã¾ã™...</h2>
                <p class="text-gray-600" id="loadingText">æ€§æ ¼ã‚¿ã‚¤ãƒ—ã‚’åˆ†æä¸­</p>
                <div class="mt-6">
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="analysisProgress" class="bg-blue-500 h-2 rounded-full transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <!-- Results Screen -->
            <div id="resultsScreen" class="fade-in" style="display: none;">
                <!-- Personal Report Card -->
                <div class="card mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-user-graduate text-blue-500 mr-3"></i>
                            <span id="childNameDisplay"></span>ã•ã‚“ã®è¨ºæ–­çµæœ
                        </h2>
                        <div class="flex gap-2 no-print">
                            <button id="shareBtn" class="btn btn-secondary">
                                <i class="fas fa-share-alt"></i>
                                ã‚·ã‚§ã‚¢
                            </button>
                            <button id="printBtn" class="btn btn-secondary">
                                <i class="fas fa-print"></i>
                                å°åˆ·
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg">
                            <h3 class="font-semibold mb-3">
                                <i class="fas fa-brain text-purple-500 mr-2"></i>
                                æ€§æ ¼ã‚¿ã‚¤ãƒ—
                            </h3>
                            <div id="personalityResult" class="text-lg font-medium"></div>
                            <div id="personalityDescription" class="text-sm text-gray-600 mt-2"></div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                            <h3 class="font-semibold mb-3">
                                <i class="fas fa-chart-pie text-green-500 mr-2"></i>
                                é©æ€§ã‚¹ã‚³ã‚¢åˆ†å¸ƒ
                            </h3>
                            <canvas id="aptitudeChart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Top 3 Recommendations -->
                <div id="recommendationsContainer">
                    <!-- Dynamic content will be inserted here -->
                </div>
                
                <!-- Cost Simulator -->
                <div class="card">
                    <h3 class="text-xl font-semibold mb-4">
                        <i class="fas fa-calculator text-green-500 mr-2"></i>
                        è²»ç”¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
                    </h3>
                    <div id="costSimulator" class="grid md:grid-cols-3 gap-4">
                        <!-- Dynamic content -->
                    </div>
                </div>
                
                <!-- Parental Advice -->
                <div class="card">
                    <h3 class="text-xl font-semibold mb-4">
                        <i class="fas fa-heart text-red-500 mr-2"></i>
                        ä¿è­·è€…ã®æ–¹ã¸ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹
                    </h3>
                    <div id="parentalAdvice" class="space-y-4">
                        <!-- Dynamic content -->
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="card text-center no-print">
                    <div class="flex flex-wrap justify-center gap-4">
                        <button id="newDiagnosisBtn" class="btn btn-primary">
                            <i class="fas fa-redo"></i>
                            æ–°ã—ã„è¨ºæ–­ã‚’å§‹ã‚ã‚‹
                        </button>
                        <button id="compareBtn" class="btn btn-secondary">
                            <i class="fas fa-users"></i>
                            å‹é”ã¨æ¯”è¼ƒ
                        </button>
                        <button id="saveResultBtn" class="btn btn-secondary">
                            <i class="fas fa-save"></i>
                            çµæœã‚’ä¿å­˜
                        </button>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-8 mt-16 no-print">
            <div class="max-w-4xl mx-auto px-4">
                <div class="grid md:grid-cols-3 gap-8">
                    <div>
                        <h3 class="font-semibold mb-4">å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ Pro</h3>
                        <p class="text-sm text-gray-300">
                            ç§‘å­¦çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ãŠå­æ§˜ã®å¯èƒ½æ€§ã‚’ç™ºè¦‹ã—ã€æœ€é©ãªç¿’ã„äº‹ã‚’ã”ææ¡ˆã—ã¾ã™ã€‚
                        </p>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-4">ãƒªãƒ³ã‚¯</h3>
                        <ul class="space-y-2 text-sm">
                            <li><a href="#privacy" class="text-gray-300 hover:text-white">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a></li>
                            <li><a href="#terms" class="text-gray-300 hover:text-white">åˆ©ç”¨è¦ç´„</a></li>
                            <li><a href="#contact" class="text-gray-300 hover:text-white">ãŠå•ã„åˆã‚ã›</a></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-4">ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹</h3>
                        <div class="flex gap-4">
                            <a href="https://x.com/appadaycreator" class="text-gray-300 hover:text-white">
                                <i class="fab fa-twitter text-xl"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="border-t border-gray-700 mt-8 pt-8 text-center text-sm text-gray-400">
                    <p>&copy; 2025 App a Day Creator. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- Share Modal -->
    <div id="shareModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-xl p-6 m-4 max-w-md w-full">
            <h3 class="text-lg font-semibold mb-4">çµæœã‚’ã‚·ã‚§ã‚¢</h3>
            <div class="space-y-3">
                <button class="w-full btn btn-primary" onclick="shareToTwitter()">
                    <i class="fab fa-twitter"></i>
                    Twitterã§ã‚·ã‚§ã‚¢
                </button>
                <button class="w-full btn btn-secondary" onclick="copyToClipboard()">
                    <i class="fas fa-copy"></i>
                    URLã‚’ã‚³ãƒ”ãƒ¼
                </button>
                <button class="w-full btn btn-secondary" onclick="closeShareModal()">
                    <i class="fas fa-times"></i>
                    é–‰ã˜ã‚‹
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // Configuration & Data Management
        // ============================================
        
        const AppConfig = {
            // Activity database with detailed information
            activities: {
                programming: {
                    name: 'ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°æ•™å®¤',
                    icon: 'ğŸ’»',
                    category: 'STEM',
                    description: 'ãƒ­ã‚¸ã‚«ãƒ«ã‚·ãƒ³ã‚­ãƒ³ã‚°ã¨å‰µé€ æ€§ã‚’è‚²ã‚€',
                    ageRange: [6, 15],
                    cost: { min: 8000, max: 20000 },
                    personality: ['logical', 'creative', 'calm'],
                    interests: ['science'],
                    activityLevel: ['low', 'medium'],
                    skills: ['è«–ç†çš„æ€è€ƒ', 'å•é¡Œè§£æ±ºåŠ›', 'å‰µé€ æ€§'],
                    benefits: 'å°†æ¥ã®ãƒ‡ã‚¸ã‚¿ãƒ«ç¤¾ä¼šã§æ´»èºã™ã‚‹åŸºç¤ã‚’èº«ã«ã¤ã‘ã‚‰ã‚Œã¾ã™',
                    affiliateUrl: 'https://example.com/programming'
                },
                english: {
                    name: 'è‹±ä¼šè©±ã‚¹ã‚¯ãƒ¼ãƒ«',
                    icon: 'ğŸ—£ï¸',
                    category: 'èªå­¦',
                    description: 'ã‚°ãƒ­ãƒ¼ãƒãƒ«ç¤¾ä¼šã§æ´»èºã™ã‚‹èªå­¦åŠ›ã‚’è‚²æˆ',
                    ageRange: [3, 15],
                    cost: { min: 6000, max: 15000 },
                    personality: ['social', 'adventurous'],
                    interests: ['language'],
                    activityLevel: ['low', 'medium', 'high'],
                    skills: ['ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŠ›', 'å›½éš›æ„Ÿè¦š', 'è¡¨ç¾åŠ›'],
                    benefits: 'å›½éš›çš„ãªè¦–é‡ã‚’åºƒã’ã€å°†æ¥ã®å¯èƒ½æ€§ã‚’æ‹¡ã’ã¾ã™',
                    affiliateUrl: 'https://example.com/english'
                },
                soccer: {
                    name: 'ã‚µãƒƒã‚«ãƒ¼ã‚¯ãƒ©ãƒ–',
                    icon: 'âš½',
                    category: 'ã‚¹ãƒãƒ¼ãƒ„',
                    description: 'ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ä½“åŠ›ã‚’åŒæ™‚ã«è‚²ã‚€',
                    ageRange: [4, 15],
                    cost: { min: 5000, max: 12000 },
                    personality: ['active', 'social'],
                    interests: ['sports'],
                    activityLevel: ['high', 'medium'],
                    skills: ['ä½“åŠ›å‘ä¸Š', 'ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯', 'ç¬ç™ºåŠ›'],
                    benefits: 'ä»²é–“ã¨å”åŠ›ã™ã‚‹å–œã³ã¨å¥åº·ãªä½“ã¥ãã‚ŠãŒã§ãã¾ã™',
                    affiliateUrl: 'https://example.com/soccer'
                },
                piano: {
                    name: 'ãƒ”ã‚¢ãƒæ•™å®¤',
                    icon: 'ğŸ¹',
                    category: 'éŸ³æ¥½',
                    description: 'éŸ³æ„Ÿã¨è¡¨ç¾åŠ›ã‚’è±Šã‹ã«è‚²ã‚€',
                    ageRange: [3, 15],
                    cost: { min: 7000, max: 18000 },
                    personality: ['calm', 'creative'],
                    interests: ['music'],
                    activityLevel: ['low', 'medium'],
                    skills: ['éŸ³æ„Ÿ', 'é›†ä¸­åŠ›', 'è¡¨ç¾åŠ›'],
                    benefits: 'æ„Ÿæ€§ã‚’è±Šã‹ã«ã—ã€ç¶™ç¶šã™ã‚‹åŠ›ã‚’èº«ã«ã¤ã‘ã‚‰ã‚Œã¾ã™',
                    affiliateUrl: 'https://example.com/piano'
                },
                swimming: {
                    name: 'æ°´æ³³æ•™å®¤',
                    icon: 'ğŸŠ',
                    category: 'ã‚¹ãƒãƒ¼ãƒ„',
                    description: 'å…¨èº«é‹å‹•ã§åŸºç¤ä½“åŠ›ã‚’å‘ä¸Š',
                    ageRange: [3, 15],
                    cost: { min: 6000, max: 10000 },
                    personality: ['active', 'calm'],
                    interests: ['sports'],
                    activityLevel: ['high', 'medium'],
                    skills: ['ä½“åŠ›å‘ä¸Š', 'å¿ƒè‚ºæ©Ÿèƒ½', 'ç¶™ç¶šåŠ›'],
                    benefits: 'ç”Ÿæ¶¯ã«ã‚ãŸã£ã¦å½¹ç«‹ã¤æŠ€è¡“ã¨ä¸ˆå¤«ãªä½“ã¥ãã‚ŠãŒã§ãã¾ã™',
                    affiliateUrl: 'https://example.com/swimming'
                },
                art: {
                    name: 'çµµç”»æ•™å®¤',
                    icon: 'ğŸ¨',
                    category: 'ã‚¢ãƒ¼ãƒˆ',
                    description: 'å‰µé€ æ€§ã¨æ„Ÿæ€§ã‚’è‡ªç”±ã«è¡¨ç¾',
                    ageRange: [3, 15],
                    cost: { min: 5000, max: 12000 },
                    personality: ['creative', 'calm'],
                    interests: ['art'],
                    activityLevel: ['low'],
                    skills: ['å‰µé€ æ€§', 'é›†ä¸­åŠ›', 'è¡¨ç¾åŠ›'],
                    benefits: 'è‡ªç”±ãªç™ºæƒ³åŠ›ã¨ç¾çš„ã‚»ãƒ³ã‚¹ã‚’è‚²ã¦ã‚‰ã‚Œã¾ã™',
                    affiliateUrl: 'https://example.com/art'
                },
                dance: {
                    name: 'ãƒ€ãƒ³ã‚¹ã‚¹ã‚¯ãƒ¼ãƒ«',
                    icon: 'ğŸ’ƒ',
                    category: 'è¡¨ç¾ãƒ»é‹å‹•',
                    description: 'ãƒªã‚ºãƒ æ„Ÿã¨è¡¨ç¾åŠ›ã‚’èº«ã«ã¤ã‘ã‚‹',
                    ageRange: [3, 15],
                    cost: { min: 6000, max: 15000 },
                    personality: ['active', 'creative', 'social'],
                    interests: ['dance', 'music'],
                    activityLevel: ['high', 'medium'],
                    skills: ['ãƒªã‚ºãƒ æ„Ÿ', 'è¡¨ç¾åŠ›', 'ä½“åŠ›å‘ä¸Š'],
                    benefits: 'éŸ³æ¥½ã«åˆã‚ã›ã¦ä½“ã‚’å‹•ã‹ã™æ¥½ã—ã•ã‚’å­¦ã¹ã¾ã™',
                    affiliateUrl: 'https://example.com/dance'
                },
                martial_arts: {
                    name: 'æ­¦é“æ•™å®¤',
                    icon: 'ğŸ¥‹',
                    category: 'ã‚¹ãƒãƒ¼ãƒ„ãƒ»ç²¾ç¥',
                    description: 'ç¤¼å„€ã¨ç²¾ç¥åŠ›ã‚’é›ãˆã‚‹',
                    ageRange: [5, 15],
                    cost: { min: 5000, max: 12000 },
                    personality: ['calm', 'active'],
                    interests: ['sports'],
                    activityLevel: ['high', 'medium'],
                    skills: ['ç¤¼å„€', 'ç²¾ç¥åŠ›', 'ä½“åŠ›å‘ä¸Š'],
                    benefits: 'å¿ƒã¨ä½“ã®ä¸¡æ–¹ã‚’é›ãˆã€ç¤¼å„€æ­£ã—ã•ã‚’èº«ã«ã¤ã‘ã‚‰ã‚Œã¾ã™',
                    affiliateUrl: 'https://example.com/martial-arts'
                }
            },
            
            // Personality type definitions
            personalityTypes: {
                active: {
                    name: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ã‚¤ãƒ—',
                    icon: 'âš¡',
                    description: 'ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ã§ä½“ã‚’å‹•ã‹ã™ã“ã¨ãŒå¤§å¥½ãã€‚ã‚¹ãƒãƒ¼ãƒ„ã‚„å¤–ã§ã®æ´»å‹•ã‚’é€šã˜ã¦æˆé•·ã—ã¾ã™ã€‚',
                    strengths: ['ä½“åŠ›ãŒã‚ã‚‹', 'ç©æ¥µçš„', 'ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç²¾ç¥æ—ºç››'],
                    recommendations: ['ä½“ã‚’ä½¿ã†ç¿’ã„äº‹', 'ãƒãƒ¼ãƒ æ´»å‹•', 'ç«¶æŠ€æ€§ã®ã‚ã‚‹ã‚‚ã®']
                },
                creative: {
                    name: 'ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã‚¿ã‚¤ãƒ—',
                    icon: 'ğŸ¨',
                    description: 'æƒ³åƒåŠ›è±Šã‹ã§è‡ªç”±ãªè¡¨ç¾ã‚’å¥½ã¿ã¾ã™ã€‚ã‚¢ãƒ¼ãƒˆã‚„éŸ³æ¥½ã§æ‰èƒ½ã‚’ç™ºæ®ã—ã¾ã™ã€‚',
                    strengths: ['æƒ³åƒåŠ›ãŒè±Šã‹', 'æ„Ÿæ€§ãŒé‹­ã„', 'ç‹¬å‰µçš„'],
                    recommendations: ['èŠ¸è¡“ç³»ã®ç¿’ã„äº‹', 'è‡ªç”±åº¦ã®é«˜ã„æ´»å‹•', 'è¡¨ç¾é‡è¦–ã®ã‚‚ã®']
                },
                logical: {
                    name: 'ãƒ­ã‚¸ã‚«ãƒ«ã‚¿ã‚¤ãƒ—',
                    icon: 'ğŸ§®',
                    description: 'ç‰©äº‹ã‚’è«–ç†çš„ã«è€ƒãˆã‚‹ã®ãŒå¾—æ„ã€‚STEMåˆ†é‡ã§åŠ›ã‚’ç™ºæ®ã—ã¾ã™ã€‚',
                    strengths: ['è«–ç†çš„æ€è€ƒ', 'åˆ†æåŠ›', 'é›†ä¸­åŠ›'],
                    recommendations: ['ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°', 'ç§‘å­¦å®Ÿé¨“', 'æ•°å­¦çš„æ€è€ƒã‚’ä½¿ã†ç¿’ã„äº‹']
                },
                social: {
                    name: 'ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã‚¿ã‚¤ãƒ—',
                    icon: 'ğŸ‘¥',
                    description: 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èƒ½åŠ›ãŒé«˜ãã€äººã¨ã®é–¢ã‚ã‚Šã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚',
                    strengths: ['ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŠ›', 'å”èª¿æ€§', 'ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—'],
                    recommendations: ['ãƒãƒ¼ãƒ æ´»å‹•', 'ç™ºè¡¨ã®æ©Ÿä¼šãŒã‚ã‚‹ç¿’ã„äº‹', 'äººã¨é–¢ã‚ã‚‹æ´»å‹•']
                },
                calm: {
                    name: 'ç©ã‚„ã‹ã‚¿ã‚¤ãƒ—',
                    icon: 'ğŸŒ¸',
                    description: 'è½ã¡ç€ã„ã¦ã„ã¦é›†ä¸­åŠ›ãŒã‚ã‚Šã¾ã™ã€‚ã˜ã£ãã‚Šã¨å–ã‚Šçµ„ã‚€æ´»å‹•ãŒå‘ã„ã¦ã„ã¾ã™ã€‚',
                    strengths: ['é›†ä¸­åŠ›', 'ç¶™ç¶šåŠ›', 'å¿è€åŠ›'],
                    recommendations: ['å€‹äººæŠ€ã‚’ç£¨ãç¿’ã„äº‹', 'é›†ä¸­ã‚’è¦ã™ã‚‹æ´»å‹•', 'ç¶™ç¶šæ€§é‡è¦–ã®ã‚‚ã®']
                },
                adventurous: {
                    name: 'å†’é™ºã‚¿ã‚¤ãƒ—',
                    icon: 'ğŸ—ºï¸',
                    description: 'æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã™ã‚‹ã®ãŒå¥½ãã§ã€å¥½å¥‡å¿ƒæ—ºç››ã§ã™ã€‚',
                    strengths: ['å¥½å¥‡å¿ƒæ—ºç››', 'ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç²¾ç¥', 'é©å¿œåŠ›'],
                    recommendations: ['æ–°ã—ã„åˆ†é‡ã®ç¿’ã„äº‹', 'å¤‰åŒ–ã®ã‚ã‚‹æ´»å‹•', 'æ¢æ±‚è¦ç´ ã®ã‚ã‚‹ã‚‚ã®']
                }
            }
        };
        
        // ============================================
        // State Management
        // ============================================
        
        class AppState {
            constructor() {
                this.currentStep = 0;
                this.maxSteps = 6;
                this.formData = {};
                this.results = null;
                this.history = [];
                this.loadFromStorage();
            }
            
            updateFormData(key, value) {
                this.formData[key] = value;
                this.saveToStorage();
                this.validateCurrentStep();
            }
            
            validateCurrentStep() {
                const stepValidations = {
                    1: () => this.formData.childName && this.formData.childAge && this.formData.budget,
                    2: () => this.formData.personality,
                    3: () => this.formData.interests && this.formData.interests.length > 0,
                    4: () => this.formData.activityLevel,
                    5: () => this.formData.transportation,
                    6: () => this.formData.goals && this.formData.goals.length > 0
                };
                
                const isValid = stepValidations[this.currentStep] ? stepValidations[this.currentStep]() : false;
                const nextBtn = document.querySelector(`#step${this.currentStep}Next, #step${this.currentStep}Submit`);
                if (nextBtn) {
                    nextBtn.disabled = !isValid;
                }
                
                return isValid;
            }
            
            saveToStorage() {
                try {
                    localStorage.setItem('kidActivityFinderState', JSON.stringify({
                        formData: this.formData,
                        history: this.history
                    }));
                } catch (e) {
                    console.warn('Failed to save to localStorage:', e);
                }
            }
            
            loadFromStorage() {
                try {
                    const saved = localStorage.getItem('kidActivityFinderState');
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.formData = data.formData || {};
                        this.history = data.history || [];
                    }
                } catch (e) {
                    console.warn('Failed to load from localStorage:', e);
                }
            }
            
            saveResult(result) {
                const resultWithTimestamp = {
                    ...result,
                    timestamp: new Date().toISOString(),
                    id: Date.now()
                };
                this.history.unshift(resultWithTimestamp);
                // Keep only last 10 results
                this.history = this.history.slice(0, 10);
                this.saveToStorage();
            }
        }
        
        // Global state instance
        const state = new AppState();
        
        // ============================================
        // Diagnostic Engine
        // ============================================
        
        class DiagnosticEngine {
            static calculateScores(formData) {
                const scores = {};
                
                // Initialize scores for all activities
                Object.keys(AppConfig.activities).forEach(key => {
                    scores[key] = 0;
                });
                
                // Age compatibility scoring
                Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                    const age = parseInt(formData.childAge);
                    const [minAge, maxAge] = activity.ageRange;
                    
                    if (age >= minAge && age <= maxAge) {
                        scores[key] += 20; // Base age compatibility bonus
                        
                        // Optimal age range bonus
                        const optimalRange = maxAge - minAge;
                        const agePosition = (age - minAge) / optimalRange;
                        if (agePosition >= 0.2 && agePosition <= 0.8) {
                            scores[key] += 10; // In optimal range
                        }
                    } else {
                        scores[key] -= 20; // Age incompatibility penalty
                    }
                });
                
                // Personality type scoring
                if (formData.personality) {
                    Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                        if (activity.personality.includes(formData.personality)) {
                            scores[key] += 25; // Strong personality match
                        }
                    });
                }
                
                // Interest-based scoring
                if (formData.interests) {
                    formData.interests.forEach(interest => {
                        Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                            if (activity.interests.includes(interest)) {
                                scores[key] += 20; // Interest match
                            }
                        });
                    });
                }
                
                // Activity level scoring
                if (formData.activityLevel) {
                    Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                        if (activity.activityLevel.includes(formData.activityLevel)) {
                            scores[key] += 15; // Activity level match
                        }
                    });
                }
                
                // Budget compatibility
                if (formData.budget) {
                    const budget = parseInt(formData.budget);
                    Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                        if (budget >= activity.cost.min) {
                            scores[key] += 10; // Can afford minimum
                            if (budget >= activity.cost.max) {
                                scores[key] += 5; // Can afford premium
                            }
                        } else {
                            scores[key] -= 15; // Budget constraint
                        }
                    });
                }
                
                // Goals alignment
                if (formData.goals) {
                    const goalActivities = {
                        skill_development: ['programming', 'piano', 'martial_arts'],
                        social_skills: ['soccer', 'dance', 'english'],
                        confidence: ['martial_arts', 'dance', 'swimming'],
                        creativity: ['art', 'piano', 'dance'],
                        discipline: ['piano', 'martial_arts', 'programming'],
                        fun: ['soccer', 'dance', 'swimming']
                    };
                    
                    formData.goals.forEach(goal => {
                        if (goalActivities[goal]) {
                            goalActivities[goal].forEach(activityKey => {
                                if (scores[activityKey] !== undefined) {
                                    scores[activityKey] += 15;
                                }
                            });
                        }
                    });
                }
                
                return scores;
            }
            
            static generateRecommendations(formData) {
                const scores = this.calculateScores(formData);
                
                // Sort activities by score
                const sortedActivities = Object.entries(scores)
                    .map(([key, score]) => ({
                        key,
                        activity: AppConfig.activities[key],
                        score: Math.max(0, score), // Ensure non-negative scores
                        compatibility: this.calculateCompatibility(score)
                    }))
                    .sort((a, b) => b.score - a.score);
                
                // Get top 3 recommendations
                const topRecommendations = sortedActivities.slice(0, 3);
                
                return {
                    recommendations: topRecommendations,
                    personalityType: AppConfig.personalityTypes[formData.personality],
                    allScores: scores,
                    formData
                };
            }
            
            static calculateCompatibility(score) {
                if (score >= 80) return { level: 'excellent', text: 'éå¸¸ã«é©ã—ã¦ã„ã‚‹', color: 'green' };
                if (score >= 60) return { level: 'good', text: 'é©ã—ã¦ã„ã‚‹', color: 'blue' };
                if (score >= 40) return { level: 'moderate', text: 'ã¾ã‚ã¾ã‚é©ã—ã¦ã„ã‚‹', color: 'yellow' };
                return { level: 'low', text: 'ã‚ã¾ã‚Šé©ã—ã¦ã„ãªã„', color: 'red' };
            }
        }
        
        // ============================================
        // UI Components
        // ============================================
        
        class UIManager {
            static showStep(stepNumber) {
                // Hide all steps
                document.querySelectorAll('.step-content').forEach(step => {
                    step.style.display = 'none';
                });
                
                // Show target step
                const targetStep = document.getElementById(`step${stepNumber}`);
                if (targetStep) {
                    targetStep.style.display = 'block';
                    targetStep.classList.add('fade-in');
                }
                
                // Update progress
                this.updateProgress(stepNumber - 1, state.maxSteps);
                
                // Show/hide progress bar
                const progressContainer = document.getElementById('progressContainer');
                if (stepNumber > 0) {
                    progressContainer.style.display = 'block';
                } else {
                    progressContainer.style.display = 'none';
                }
                
                state.currentStep = stepNumber;
            }
            
            static updateProgress(current, total) {
                const percentage = (current / total) * 100;
                const progressFill = document.getElementById('progressFill');
                const progressText = document.getElementById('progressText');
                
                if (progressFill) {
                    progressFill.style.width = `${percentage}%`;
                }
                
                if (progressText) {
                    progressText.textContent = `${current}/${total}`;
                }
            }
            
            static showLoading() {
                document.getElementById('stepContainer').style.display = 'none';
                document.getElementById('loadingScreen').style.display = 'block';
                
                const messages = [
                    'æ€§æ ¼ã‚¿ã‚¤ãƒ—ã‚’åˆ†æä¸­',
                    'èˆˆå‘³é–¢å¿ƒã‚’è©•ä¾¡ä¸­',
                    'é©æ€§ãƒãƒƒãƒãƒ³ã‚°ã‚’å®Ÿè¡Œä¸­',
                    'æœ€é©ãªç¿’ã„äº‹ã‚’é¸å®šä¸­',
                    'è¨ºæ–­çµæœã‚’æº–å‚™ä¸­'
                ];
                
                let messageIndex = 0;
                let progress = 0;
                
                const interval = setInterval(() => {
                    const loadingText = document.getElementById('loadingText');
                    const analysisProgress = document.getElementById('analysisProgress');
                    
                    if (loadingText && messageIndex < messages.length) {
                        loadingText.textContent = messages[messageIndex];
                        messageIndex++;
                    }
                    
                    progress += 20;
                    if (analysisProgress) {
                        analysisProgress.style.width = `${progress}%`;
                    }
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => this.showResults(), 500);
                    }
                }, 800);
            }
            
            static showResults() {
                const results = DiagnosticEngine.generateRecommendations(state.formData);
                state.results = results;
                state.saveResult(results);
                
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('progressContainer').style.display = 'none';
                document.getElementById('resultsScreen').style.display = 'block';
                
                this.renderResults(results);
            }
            
            static renderResults(results) {
                // Update child name display
                const childNameDisplay = document.getElementById('childNameDisplay');
                if (childNameDisplay) {
                    childNameDisplay.textContent = results.formData.childName || 'ãŠå­æ§˜';
                }
                
                // Render personality type
                this.renderPersonalityResult(results.personalityType);
                
                // Render aptitude chart
                this.renderAptitudeChart(results.allScores);
                
                // Render recommendations
                this.renderRecommendations(results.recommendations);
                
                // Render cost simulator
                this.renderCostSimulator(results.recommendations);
                
                // Render parental advice
                this.renderParentalAdvice(results);
            }
            
            static renderPersonalityResult(personalityType) {
                const personalityResult = document.getElementById('personalityResult');
                const personalityDescription = document.getElementById('personalityDescription');
                
                if (personalityResult && personalityType) {
                    personalityResult.innerHTML = `
                        <div class="flex items-center gap-2">
                            <span class="text-2xl">${personalityType.icon}</span>
                            <span>${personalityType.name}</span>
                        </div>
                    `;
                }
                
                if (personalityDescription && personalityType) {
                    personalityDescription.textContent = personalityType.description;
                }
            }
            
            static renderAptitudeChart(scores) {
                const ctx = document.getElementById('aptitudeChart');
                if (!ctx) return;
                
                const labels = Object.keys(scores).map(key => 
                    AppConfig.activities[key]?.name || key
                ).slice(0, 6); // Top 6 for readability
                
                const data = Object.values(scores).slice(0, 6);
                
                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'é©æ€§ã‚¹ã‚³ã‚¢',
                            data: data,
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            borderColor: 'rgba(59, 130, 246, 0.8)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    stepSize: 20
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
            
            static renderRecommendations(recommendations) {
                const container = document.getElementById('recommendationsContainer');
                if (!container) return;
                
                container.innerHTML = recommendations.map((rec, index) => `
                    <div class="result-card">
                        <div class="result-rank">#${index + 1}</div>
                        <div class="grid md:grid-cols-3 gap-6">
                            <div class="md:col-span-2">
                                <div class="flex items-center gap-4 mb-4">
                                    <div class="text-4xl">${rec.activity.icon}</div>
                                    <div>
                                        <h3 class="text-xl font-bold text-gray-800">${rec.activity.name}</h3>
                                        <p class="text-gray-600">${rec.activity.category}</p>
                                    </div>
                                </div>
                                
                                <p class="text-gray-700 mb-4">${rec.activity.description}</p>
                                
                                <div class="mb-4">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="font-medium">é©æ€§åº¦:</span>
                                        <div class="flex-1 bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-1000" 
                                                 style="width: ${rec.score}%"></div>
                                        </div>
                                        <span class="text-sm font-medium text-${rec.compatibility.color}-600">
                                            ${rec.compatibility.text}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="grid md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <h4 class="font-medium mb-2">èº«ã«ã¤ãã‚¹ã‚­ãƒ«</h4>
                                        <ul class="text-sm space-y-1">
                                            ${rec.activity.skills.map(skill => `<li>â€¢ ${skill}</li>`).join('')}
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 class="font-medium mb-2">è²»ç”¨ç›®å®‰</h4>
                                        <p class="text-sm">æœˆé¡ ${rec.activity.cost.min.toLocaleString()}å††ã€œ${rec.activity.cost.max.toLocaleString()}å††</p>
                                        <p class="text-sm text-gray-600">å¹´é½¢: ${rec.activity.ageRange[0]}æ­³ã€œ${rec.activity.ageRange[1]}æ­³</p>
                                    </div>
                                </div>
                                
                                <div class="bg-blue-50 p-4 rounded-lg mb-4">
                                    <h4 class="font-medium mb-2">æœŸå¾…ã§ãã‚‹åŠ¹æœ</h4>
                                    <p class="text-sm text-gray-700">${rec.activity.benefits}</p>
                                </div>
                            </div>
                            
                            <div class="space-y-4">
                                <a href="${rec.activity.affiliateUrl}" target="_blank" rel="noopener noreferrer" 
                                   class="block btn btn-primary text-center w-full">
                                    <i class="fas fa-external-link-alt"></i>
                                    æ•™å®¤ã‚’æ¢ã™
                                </a>
                                
                                <button class="btn btn-secondary w-full" onclick="shareActivity('${rec.key}')">
                                    <i class="fas fa-share-alt"></i>
                                    ã“ã®ç¿’ã„äº‹ã‚’ã‚·ã‚§ã‚¢
                                </button>
                                
                                <div class="text-xs text-gray-500 text-center">
                                    <i class="fas fa-info-circle"></i>
                                    ä½“é¨“ãƒ¬ãƒƒã‚¹ãƒ³æƒ…å ±ã‚‚ãƒã‚§ãƒƒã‚¯ï¼
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            static renderCostSimulator(recommendations) {
                const container = document.getElementById('costSimulator');
                if (!container) return;
                
                container.innerHTML = recommendations.map(rec => `
                    <div class="bg-white p-4 rounded-lg border border-gray-200">
                        <h4 class="font-medium mb-3">${rec.activity.name}</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>æœˆè¬</span>
                                <span>${rec.activity.cost.min.toLocaleString()}ã€œ${rec.activity.cost.max.toLocaleString()}å††</span>
                            </div>
                            <div class="flex justify-between">
                                <span>å¹´é–“è²»ç”¨</span>
                                <span>${(rec.activity.cost.min * 12).toLocaleString()}ã€œ${(rec.activity.cost.max * 12).toLocaleString()}å††</span>
                            </div>
                            <div class="border-t pt-2 font-medium">
                                <div class="flex justify-between">
                                    <span>å…¥ä¼šé‡‘è¾¼ã¿æ¦‚ç®—</span>
                                    <span>${(rec.activity.cost.min * 12 + 10000).toLocaleString()}å††ã€œ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            static renderParentalAdvice(results) {
                const container = document.getElementById('parentalAdvice');
                if (!container) return;
                
                const personalityType = results.personalityType;
                const topActivity = results.recommendations[0];
                
                const advice = `
                    <div class="bg-gradient-to-r from-pink-50 to-purple-50 p-6 rounded-lg">
                        <h4 class="font-semibold mb-3">
                            <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
                            ${personalityType.name}ã®ãŠå­æ§˜ã¸ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹
                        </h4>
                        <p class="mb-4">${personalityType.description}</p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <h5 class="font-medium mb-2">å¼·ã¿ã‚’æ´»ã‹ã™ãƒã‚¤ãƒ³ãƒˆ</h5>
                                <ul class="text-sm space-y-1">
                                    ${personalityType.strengths.map(strength => `<li>â€¢ ${strength}</li>`).join('')}
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-medium mb-2">ç¿’ã„äº‹é¸ã³ã®ãƒ’ãƒ³ãƒˆ</h5>
                                <ul class="text-sm space-y-1">
                                    ${personalityType.recommendations.map(rec => `<li>â€¢ ${rec}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                        <h4 class="font-semibold mb-3">
                            <i class="fas fa-heart text-red-500 mr-2"></i>
                            æˆåŠŸã®ãŸã‚ã®ã‚µãƒãƒ¼ãƒˆæ–¹æ³•
                        </h4>
                        <div class="space-y-3 text-sm">
                            <div>
                                <strong>ç¶™ç¶šã®ã‚³ãƒ„:</strong> 
                                ãŠå­æ§˜ã®å°ã•ãªæˆé•·ã‚‚è¦‹é€ƒã•ãšã€ç©æ¥µçš„ã«è¤’ã‚ã¦ã‚ã’ã¾ã—ã‚‡ã†ã€‚ç¿’ã„äº‹ã§ã®æ¥½ã—ã„å‡ºæ¥äº‹ã‚’èã„ã¦ä¸€ç·’ã«å–œã¶ã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚
                            </div>
                            <div>
                                <strong>ä½“é¨“ãƒ¬ãƒƒã‚¹ãƒ³ã®æ´»ç”¨:</strong> 
                                ã¾ãšã¯ä½“é¨“ãƒ¬ãƒƒã‚¹ãƒ³ã‚’å—ã‘ã¦ã€ãŠå­æ§˜ã®åå¿œã‚’ã‚ˆãè¦³å¯Ÿã—ã¦ãã ã•ã„ã€‚å¼·åˆ¶çš„ã«æ±ºã‚ã‚‹ã®ã§ã¯ãªãã€ãŠå­æ§˜ã®æ„æ€ã‚’å°Šé‡ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
                            </div>
                            <div>
                                <strong>ä»–ã®ç¿’ã„äº‹ã¨ã®ä¸¡ç«‹:</strong> 
                                ãŠå­æ§˜ã®è² æ‹…ã«ãªã‚‰ãªã„ã‚ˆã†ã€é€±1å›ã‹ã‚‰å§‹ã‚ã¦å¾ã€…ã«æ…£ã‚Œã•ã›ã¦ã‚ã’ã¦ãã ã•ã„ã€‚è¤‡æ•°ã®ç¿’ã„äº‹ã‚’æ¤œè¨ã™ã‚‹å ´åˆã¯ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ä½™è£•ã‚’æŒãŸã›ã‚‹ã“ã¨ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†ã€‚
                            </div>
                        </div>
                    </div>
                `;
                
                container.innerHTML = advice;
            }
            
            static showWelcome() {
                document.getElementById('welcomeScreen').style.display = 'block';
                document.getElementById('stepContainer').style.display = 'none';
                document.getElementById('resultsScreen').style.display = 'none';
                document.getElementById('progressContainer').style.display = 'none';
                state.currentStep = 0;
            }
        }
        
        // ============================================
        // Event Handlers
        // ============================================
        
        function validateInput(inputElement, errorElementId, validationFn, errorMessage) {
            const isValid = validationFn(inputElement.value);
            const errorElement = document.getElementById(errorElementId);
            
            if (isValid) {
                inputElement.classList.remove('error');
                if (errorElement) errorElement.style.display = 'none';
            } else {
                inputElement.classList.add('error');
                if (errorElement) {
                    errorElement.style.display = 'flex';
                    errorElement.textContent = errorMessage;
                }
            }
            
            return isValid;
        }
        
        function setupValidation() {
            // Child name validation
            const childNameInput = document.getElementById('childName');
            if (childNameInput) {
                childNameInput.addEventListener('input', (e) => {
                    const isValid = validateInput(
                        e.target, 
                        'childName-error', 
                        value => value.trim().length >= 1,
                        'ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'
                    );
                    if (isValid) {
                        state.updateFormData('childName', e.target.value.trim());
                    }
                });
            }
            
            // Age validation
            const childAgeSelect = document.getElementById('childAge');
            if (childAgeSelect) {
                childAgeSelect.addEventListener('change', (e) => {
                    const isValid = validateInput(
                        e.target,
                        'childAge-error',
                        value => value !== '',
                        'å¹´é½¢ã‚’é¸æŠã—ã¦ãã ã•ã„'
                    );
                    if (isValid) {
                        state.updateFormData('childAge', e.target.value);
                    }
                });
            }
            
            // Budget validation
            const budgetSelect = document.getElementById('budget');
            if (budgetSelect) {
                budgetSelect.addEventListener('change', (e) => {
                    const isValid = validateInput(
                        e.target,
                        'budget-error',
                        value => value !== '',
                        'äºˆç®—ã‚’é¸æŠã—ã¦ãã ã•ã„'
                    );
                    if (isValid) {
                        state.updateFormData('budget', e.target.value);
                    }
                });
            }
            
            // Gender (optional)
            const genderSelect = document.getElementById('gender');
            if (genderSelect) {
                genderSelect.addEventListener('change', (e) => {
                    state.updateFormData('gender', e.target.value);
                });
            }
            
            // Personality radio buttons
            document.querySelectorAll('input[name="personality"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        state.updateFormData('personality', e.target.value);
                    }
                });
            });
            
            // Interests checkboxes
            document.querySelectorAll('input[name="interests"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    const selectedInterests = Array.from(document.querySelectorAll('input[name="interests"]:checked'))
                        .map(cb => cb.value);
                    state.updateFormData('interests', selectedInterests);
                });
            });
            
            // Activity level radio buttons
            document.querySelectorAll('input[name="activityLevel"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        state.updateFormData('activityLevel', e.target.value);
                    }
                });
            });
            
            // Transportation radio buttons
            document.querySelectorAll('input[name="transportation"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        state.updateFormData('transportation', e.target.value);
                    }
                });
            });
            
            // Time slots checkboxes
            document.querySelectorAll('input[name="timeSlots"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    const selectedTimeSlots = Array.from(document.querySelectorAll('input[name="timeSlots"]:checked'))
                        .map(cb => cb.value);
                    state.updateFormData('timeSlots', selectedTimeSlots);
                });
            });
            
            // Goals checkboxes
            document.querySelectorAll('input[name="goals"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    const selectedGoals = Array.from(document.querySelectorAll('input[name="goals"]:checked'))
                        .map(cb => cb.value);
                    state.updateFormData('goals', selectedGoals);
                });
            });
        }
        
        // ============================================
        // Navigation & Main Functions
        // ============================================
        
        function nextStep() {
            if (state.currentStep < state.maxSteps) {
                UIManager.showStep(state.currentStep + 1);
            }
        }
        
        function previousStep() {
            if (state.currentStep > 1) {
                UIManager.showStep(state.currentStep - 1);
            }
        }
        
        function startDiagnosis() {
            UIManager.showStep(1);
        }
        
        function submitDiagnosis() {
            if (state.validateCurrentStep()) {
                UIManager.showLoading();
            }
        }
        
        function restartDiagnosis() {
            state.formData = {};
            state.results = null;
            state.saveToStorage();
            
            // Reset form elements
            document.querySelectorAll('input, select').forEach(element => {
                if (element.type === 'checkbox' || element.type === 'radio') {
                    element.checked = false;
                } else {
                    element.value = '';
                }
                element.classList.remove('error');
            });
            
            // Hide error messages
            document.querySelectorAll('.error-message').forEach(error => {
                error.style.display = 'none';
            });
            
            UIManager.showWelcome();
        }
        
        // ============================================
        // Share & Social Functions
        // ============================================
        
        function shareToTwitter() {
            const result = state.results;
            if (!result) return;
            
            const topActivity = result.recommendations[0];
            const url = window.location.href;
            
            const tweetText = `å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ã®çµæœã€${result.formData.childName}ã•ã‚“ã«ã¯ã€Œ${topActivity.activity.name}ã€ãŒãŠã™ã™ã‚ï¼${topActivity.activity.icon} 

é©æ€§åº¦: ${topActivity.compatibility.text}
æ€§æ ¼ã‚¿ã‚¤ãƒ—: ${result.personalityType.name}

ã‚ãªãŸã®ãŠå­æ§˜ã«ã¯ã©ã‚“ãªç¿’ã„äº‹ãŒå‘ã„ã¦ã„ã‚‹ã‹ãªï¼Ÿ

#ç¶™ç¶šã¯åŠ›ãªã‚Š #ç¿’ã„äº‹è¨ºæ–­ #å­è‚²ã¦ #æ•™è‚² #ç„¡æ–™è¨ºæ–­

${url}`;
            
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
            window.open(twitterUrl, '_blank', 'width=600,height=400');
            closeShareModal();
        }
        
        function copyToClipboard() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('URLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
                closeShareModal();
            }).catch(err => {
                console.error('Failed to copy:', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('URLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
                closeShareModal();
            });
        }
        
        function shareActivity(activityKey) {
            const activity = AppConfig.activities[activityKey];
            if (!activity) return;
            
            const url = window.location.href;
            const tweetText = `ã€Œ${activity.name}ã€ãŒæ°—ã«ãªã‚‹ï¼${activity.icon}

${activity.description}

å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ã§è©³ã—ããƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã‚ˆã†âœ¨

#ç¶™ç¶šã¯åŠ›ãªã‚Š #ç¿’ã„äº‹ #${activity.category} #å­è‚²ã¦

${url}`;
            
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
            window.open(twitterUrl, '_blank', 'width=600,height=400');
        }
        
        function openShareModal() {
            document.getElementById('shareModal').style.display = 'flex';
        }
        
        function closeShareModal() {
            document.getElementById('shareModal').style.display = 'none';
        }
        
        function printResults() {
            window.print();
        }
        
        // ============================================
        // History & Storage Functions
        // ============================================
        
        function showHistory() {
            if (state.history.length === 0) {
                alert('è¨ºæ–­å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
                return;
            }
            
            const historyHtml = state.history.map((result, index) => `
                <div class="border-b pb-4 mb-4">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium">${result.formData.childName || 'åç„¡ã—'}ã•ã‚“ã®è¨ºæ–­çµæœ</h4>
                            <p class="text-sm text-gray-600">${new Date(result.timestamp).toLocaleDateString('ja-JP')}</p>
                            <p class="text-sm">1ä½: ${result.recommendations[0].activity.name}</p>
                        </div>
                        <button onclick="loadHistoryResult(${index})" class="btn btn-primary text-sm">
                            è©³ç´°ã‚’è¦‹ã‚‹
                        </button>
                    </div>
                </div>
            `).join('');
            
            const modalHtml = `
                <div id="historyModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <div class="bg-white rounded-xl p-6 m-4 max-w-2xl w-full max-h-96 overflow-y-auto">
                        <h3 class="text-lg font-semibold mb-4">è¨ºæ–­å±¥æ­´</h3>
                        <div class="space-y-4">
                            ${historyHtml}
                        </div>
                        <button onclick="closeHistoryModal()" class="btn btn-secondary w-full mt-4">
                            é–‰ã˜ã‚‹
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }
        
        function loadHistoryResult(index) {
            const result = state.history[index];
            if (!result) return;
            
            state.results = result;
            state.formData = result.formData;
            
            closeHistoryModal();
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('stepContainer').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';
            document.getElementById('progressContainer').style.display = 'none';
            
            UIManager.renderResults(result);
        }
        
        function closeHistoryModal() {
            const modal = document.getElementById('historyModal');
            if (modal) {
                modal.remove();
            }
        }
        
        function compareWithFriends() {
            const result = state.results;
            if (!result) return;
            
            const shareText = `å‹é”ã¨æ¯”è¼ƒï¼${result.formData.childName}ã•ã‚“ã®è¨ºæ–­çµæœ:

ğŸ† 1ä½: ${result.recommendations[0].activity.name} (${result.recommendations[0].compatibility.text})
ğŸ¥ˆ 2ä½: ${result.recommendations[1].activity.name} (${result.recommendations[1].compatibility.text})  
ğŸ¥‰ 3ä½: ${result.recommendations[2].activity.name} (${result.recommendations[2].compatibility.text})

æ€§æ ¼ã‚¿ã‚¤ãƒ—: ${result.personalityType.name}

ã¿ã‚“ãªã®çµæœã¯ã©ã†ã‹ãªï¼Ÿ

#ç¶™ç¶šã¯åŠ›ãªã‚Š #ç¿’ã„äº‹è¨ºæ–­ #å‹é”ã¨æ¯”è¼ƒ

${window.location.href}`;
            
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}`;
            window.open(twitterUrl, '_blank', 'width=600,height=400');
        }
        
        function saveCurrentResult() {
            if (state.results) {
                state.saveResult(state.results);
                alert('è¨ºæ–­çµæœã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
            }
        }
        
        // ============================================
        // PWA & Service Worker
        // ============================================
        
        function initServiceWorker() {
            if ('serviceWorker' in navigator) {
                const swCode = `
                    const CACHE_NAME = 'kids-activity-finder-v1';
                    const urlsToCache = [
                        '/',
                        '/index.html'
                    ];
                    
                    self.addEventListener('install', event => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then(cache => cache.addAll(urlsToCache))
                        );
                    });
                    
                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            caches.match(event.request)
                                .then(response => response || fetch(event.request))
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then(() => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed'));
            }
        }
        
        // ============================================
        // Initialization
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize UI
            UIManager.showWelcome();
            
            // Setup form validation
            setupValidation();
            
            // Setup event listeners
            document.getElementById('startBtn')?.addEventListener('click', startDiagnosis);
            document.getElementById('step1Next')?.addEventListener('click', nextStep);
            document.getElementById('step2Next')?.addEventListener('click', nextStep);
            document.getElementById('step3Next')?.addEventListener('click', nextStep);
            document.getElementById('step4Next')?.addEventListener('click', nextStep);
            document.getElementById('step5Next')?.addEventListener('click', nextStep);
            document.getElementById('step6Submit')?.addEventListener('click', submitDiagnosis);
            
            document.getElementById('step2Back')?.addEventListener('click', previousStep);
            document.getElementById('step3Back')?.addEventListener('click', previousStep);
            document.getElementById('step4Back')?.addEventListener('click', previousStep);
            document.getElementById('step5Back')?.addEventListener('click', previousStep);
            document.getElementById('step6Back')?.addEventListener('click', previousStep);
            
            document.getElementById('shareBtn')?.addEventListener('click', openShareModal);
            document.getElementById('printBtn')?.addEventListener('click', printResults);
            document.getElementById('newDiagnosisBtn')?.addEventListener('click', restartDiagnosis);
            document.getElementById('compareBtn')?.addEventListener('click', compareWithFriends);
            document.getElementById('saveResultBtn')?.addEventListener('click', saveCurrentResult);
            document.getElementById('historyBtn')?.addEventListener('click', showHistory);
            
            // Close modal when clicking outside
            document.getElementById('shareModal')?.addEventListener('click', (e) => {
                if (e.target.id === 'shareModal') {
                    closeShareModal();
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeShareModal();
                    closeHistoryModal();
                }
            });
            
            // Initialize PWA
            initServiceWorker();
            
            // Add install prompt for PWA
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                
                // Show install button if not already installed
                if (!window.matchMedia('(display-mode: standalone)').matches) {
                    const installBtn = document.createElement('button');
                    installBtn.textContent = 'ã‚¢ãƒ—ãƒªã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«';
                    installBtn.className = 'btn btn-secondary text-sm';
                    installBtn.onclick = () => {
                        deferredPrompt.prompt();
                        deferredPrompt.userChoice.then((choiceResult) => {
                            if (choiceResult.outcome === 'accepted') {
                                console.log('User accepted the install prompt');
                            }
                            deferredPrompt = null;
                            installBtn.remove();
                        });
                    };
                    
                    document.querySelector('header .flex').appendChild(installBtn);
                }
            });
            
            console.log('ğŸ¯ å­ä¾›ã®ç¿’ã„äº‹è¨ºæ–­ Pro ãŒåˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ');
        });
        
        // ============================================
        // Utility Functions
        // ============================================
        
        // Debounce function for performance
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('ja-JP', {
                style: 'currency',
                currency: 'JPY'
            }).format(amount);
        }
        
        // Error boundary
        window.addEventListener('error', (e) => {
            console.error('Application error:', e.error);
            // In a real app, you might want to send this to a logging service
        });
        
        // Performance monitoring
        window.addEventListener('load', () => {
            if ('performance' in window) {
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                console.log(`ğŸš€ Page loaded in ${loadTime}ms`);
            }
        });
    </script>
</body>
</html>
