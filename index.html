<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠ Pro - „ÅäÂ≠êÊßò„Å´„Å¥„Å£„Åü„Çä„ÅÆÁøí„ÅÑ‰∫ã„ÇíË¶ã„Å§„Åë„Çà„ÅÜ</title>
    <meta name="description" content="ÊÄßÊ†º„Å®ËààÂë≥„Åã„ÇâÊúÄÈÅ©„Å™Áøí„ÅÑ‰∫ã„ÇíË®∫Êñ≠„ÄÇ„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞„ÄÅËã±‰ºöË©±„ÄÅ„Çπ„Éù„Éº„ÉÑ„ÄÅÈü≥Ê•Ω„Å™„Å©ÂπÖÂ∫É„Åè„Çµ„Éù„Éº„Éà">
    <meta name="keywords" content="Â≠ê‰æõ, Áøí„ÅÑ‰∫ã, Ë®∫Êñ≠, ÊïôËÇ≤, „Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞, Ëã±‰ºöË©±, „Çπ„Éù„Éº„ÉÑ, Èü≥Ê•Ω">
    
    <!-- OGP Tags -->
    <meta property="og:title" content="Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠ Pro - „ÅäÂ≠êÊßò„Å´„Å¥„Å£„Åü„Çä„ÅÆÁøí„ÅÑ‰∫ã„ÇíË¶ã„Å§„Åë„Çà„ÅÜ">
    <meta property="og:description" content="ÊÄßÊ†º„Å®ËààÂë≥„Åã„ÇâÊúÄÈÅ©„Å™Áøí„ÅÑ‰∫ã„ÇíË®∫Êñ≠„ÄÇ„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞„ÄÅËã±‰ºöË©±„ÄÅ„Çπ„Éù„Éº„ÉÑ„ÄÅÈü≥Ê•Ω„Å™„Å©ÂπÖÂ∫É„Åè„Çµ„Éù„Éº„Éà">
    <meta property="og:image" content="https://cdn1.genspark.ai/user-upload-image/22_generated/1b2b567c-0e98-49ba-9ed5-13daec7598d5">
    <meta property="og:url" content="https://appadaycreator.github.io/kids-activity-finder-pro/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠ Pro">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠ Pro">
    <meta name="twitter:description" content="ÊÄßÊ†º„Å®ËààÂë≥„Åã„ÇâÊúÄÈÅ©„Å™Áøí„ÅÑ‰∫ã„ÇíË®∫Êñ≠">
    <meta name="twitter:image" content="https://cdn1.genspark.ai/user-upload-image/22_generated/1b2b567c-0e98-49ba-9ed5-13daec7598d5">
    <meta name="twitter:site" content="@appadaycreator">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json,{&quot;name&quot;:&quot;Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠ Pro&quot;,&quot;short_name&quot;:&quot;Áøí„ÅÑ‰∫ãË®∫Êñ≠&quot;,&quot;start_url&quot;:&quot;/&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;background_color&quot;:&quot;#fff5f5&quot;,&quot;theme_color&quot;:&quot;#ff6b9d&quot;,&quot;icons&quot;:[{&quot;src&quot;:&quot;data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>&quot;,&quot;sizes&quot;:&quot;192x192&quot;,&quot;type&quot;:&quot;image/svg+xml&quot;}]}">
    
    <!-- External Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Fredoka+One:wght@400&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TXQGZRF9');</script>
    
    <style>
        :root {
            /* Color Palette - Kid-friendly but professional */
            --primary-50: #fef2f2;
            --primary-100: #fee2e2;
            --primary-200: #fecaca;
            --primary-300: #fca5a5;
            --primary-400: #f87171;
            --primary-500: #ef4444;
            --primary-600: #dc2626;
            --primary-700: #b91c1c;
            --primary-800: #991b1b;
            --primary-900: #7f1d1d;
            
            --accent-50: #f0f9ff;
            --accent-100: #e0f2fe;
            --accent-200: #bae6fd;
            --accent-300: #7dd3fc;
            --accent-400: #38bdf8;
            --accent-500: #0ea5e9;
            --accent-600: #0284c7;
            --accent-700: #0369a1;
            --accent-800: #075985;
            --accent-900: #0c4a6e;
            
            --success-50: #f0fdf4;
            --success-500: #22c55e;
            --warning-50: #fffbeb;
            --warning-500: #f59e0b;
            --error-50: #fef2f2;
            --error-500: #ef4444;
            
            /* Typography */
            --font-primary: 'Noto Sans JP', sans-serif;
            --font-heading: 'Fredoka One', cursive;
            
            /* Spacing */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            
            /* Animations */
            --transition-fast: 150ms ease;
            --transition-normal: 250ms ease;
            --transition-slow: 350ms ease;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-primary);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--accent-50) 100%);
            min-height: 100vh;
        }
        
        /* Custom Components */
        .card {
            background: white;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            padding: var(--space-xl);
            margin: var(--space-md);
            transition: all var(--transition-normal);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-lg);
            font-weight: 500;
            text-decoration: none;
            transition: all var(--transition-normal);
            cursor: pointer;
            border: none;
            font-size: 1rem;
            min-height: 44px; /* Touch target */
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-700) 100%);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary-600);
            border: 2px solid var(--primary-200);
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: var(--primary-50);
            border-color: var(--primary-300);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--primary-100);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin: var(--space-lg) 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-500) 0%, var(--accent-500) 100%);
            border-radius: var(--radius-sm);
            transition: width var(--transition-slow);
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: var(--space-lg);
        }
        
        .form-label {
            display: block;
            margin-bottom: var(--space-sm);
            font-weight: 500;
            color: var(--primary-700);
        }
        
        .form-input {
            width: 100%;
            padding: var(--space-md);
            border: 2px solid var(--primary-200);
            border-radius: var(--radius-md);
            font-size: 1rem;
            transition: all var(--transition-fast);
            background: white;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .form-input.error {
            border-color: var(--error-500);
        }
        
        .error-message {
            color: var(--error-500);
            font-size: 0.875rem;
            margin-top: var(--space-xs);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }
        
        /* Radio Group */
        .radio-group {
            display: grid;
            gap: var(--space-md);
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }
        
        .radio-option {
            position: relative;
            cursor: pointer;
        }
        
        .radio-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .radio-card {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-lg);
            border: 2px solid var(--primary-200);
            border-radius: var(--radius-lg);
            background: white;
            transition: all var(--transition-normal);
            min-height: 80px;
        }
        
        .radio-option input[type="radio"]:checked + .radio-card {
            border-color: var(--primary-500);
            background: var(--primary-50);
            transform: scale(1.02);
            box-shadow: var(--shadow-md);
        }
        
        .radio-card:hover {
            border-color: var(--primary-300);
            background: var(--primary-25);
        }
        
        .radio-icon {
            font-size: 2rem;
            color: var(--primary-500);
            width: 60px;
            text-align: center;
        }
        
        .radio-content h3 {
            margin: 0 0 var(--space-xs) 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-700);
        }
        
        .radio-content p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--primary-600);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0, -30px, 0); }
            70% { transform: translate3d(0, -15px, 0); }
            90% { transform: translate3d(0, -4px, 0); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        .slide-in {
            animation: slideIn 0.4s ease-out;
        }
        
        /* Loading Spinner */
        .spinner {
            border: 3px solid var(--primary-200);
            border-top: 3px solid var(--primary-500);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Result Cards */
        .result-card {
            background: linear-gradient(135deg, white 0%, var(--primary-25) 100%);
            border: 2px solid var(--primary-200);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin: var(--space-lg) 0;
            position: relative;
            overflow: hidden;
        }
        
        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-500) 0%, var(--accent-500) 100%);
        }
        
        .result-rank {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
            color: white;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .card {
                margin: var(--space-sm);
                padding: var(--space-lg);
            }
            
            .radio-group {
                grid-template-columns: 1fr;
            }
            
            .radio-card {
                padding: var(--space-md);
            }
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Focus visible for keyboard navigation */
        .btn:focus-visible,
        .form-input:focus-visible {
            outline: 2px solid var(--primary-500);
            outline-offset: 2px;
        }
        
        /* Print Styles */
        @media print {
            .no-print { display: none !important; }
            .card { box-shadow: none; border: 1px solid #ccc; }
            body { background: white; }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1a1a1a;
                --text-primary: #ffffff;
                --text-secondary: #d1d5db;
            }
        }
        
        /* High contrast mode */
        @media (prefers-contrast: high) {
            .card {
                border: 2px solid var(--primary-600);
            }
            
            .btn-primary {
                background: var(--primary-700);
            }
        }
        
        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXQGZRF9"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
    <div id="app" class="min-h-screen">
        <!-- Header -->
        <header class="bg-white shadow-md sticky top-0 z-50">
            <div class="max-w-4xl mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="text-3xl">üéØ</div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-800" style="font-family: var(--font-heading)">
                                Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠ Pro
                            </h1>
                            <p class="text-sm text-gray-600">„ÅäÂ≠êÊßò„Å´„Å¥„Å£„Åü„Çä„ÅÆÁøí„ÅÑ‰∫ã„ÇíË¶ã„Å§„Åë„Çà„ÅÜ</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 no-print">
                        <button id="historyBtn" class="btn btn-secondary text-sm" aria-label="Ë®∫Êñ≠Â±•Ê≠¥„ÇíË°®Á§∫">
                            <i class="fas fa-history"></i>
                            Â±•Ê≠¥
                        </button>
                        <button id="settingsBtn" class="btn btn-secondary text-sm" aria-label="Ë®≠ÂÆö„ÇíÈñã„Åè">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Progress Bar -->
        <div id="progressContainer" class="max-w-4xl mx-auto px-4 py-2" style="display: none;">
            <div class="flex items-center gap-4">
                <span class="text-sm font-medium text-gray-600">ÈÄ≤Êçó</span>
                <div class="flex-1">
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
                <span id="progressText" class="text-sm font-medium text-gray-600">0/6</span>
            </div>
        </div>
        
        <!-- Main Content -->
        <main class="max-w-4xl mx-auto px-4 py-8">
            <!-- Welcome Screen -->
            <div id="welcomeScreen" class="card fade-in text-center">
                <div class="mb-8">
                    <img src="https://cdn1.genspark.ai/user-upload-image/22_generated/1b2b567c-0e98-49ba-9ed5-13daec7598d5" 
                         alt="Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ã„ÅÆ„Ç§„É°„Éº„Ç∏" 
                         class="w-full max-w-md mx-auto rounded-xl shadow-lg mb-6">
                </div>
                
                <h2 class="text-3xl font-bold mb-4 text-gray-800" style="font-family: var(--font-heading)">
                    „ÅäÂ≠êÊßò„ÅÆÂèØËÉΩÊÄß„ÇíÁô∫Ë¶ã„Åó„Çà„ÅÜÔºÅ
                </h2>
                
                <p class="text-lg text-gray-600 mb-8 max-w-2xl mx-auto">
                    ÊÄßÊ†ºÂàÜÊûê„Å®ÈÅ©ÊÄßË®∫Êñ≠„Åß„ÄÅ„ÅäÂ≠êÊßò„Å´„Å¥„Å£„Åü„Çä„ÅÆÁøí„ÅÑ‰∫ã„Çí„ÅîÊèêÊ°à„Åó„Åæ„Åô„ÄÇ
                    ÁßëÂ≠¶ÁöÑ„Å™„Ç¢„Éó„É≠„Éº„ÉÅ„Åß„ÄÅ„ÅäÂ≠êÊßò„ÅÆÈö†„Çå„ÅüÊâçËÉΩ„ÇíË¶ã„Å§„Åë„Å¶„Åø„Åæ„Åõ„Çì„ÅãÔºü
                </p>
                
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="text-center">
                        <div class="text-4xl mb-3">üß†</div>
                        <h3 class="font-semibold mb-2">ÊÄßÊ†ºÂàÜÊûê</h3>
                        <p class="text-sm text-gray-600">„ÅäÂ≠êÊßò„ÅÆÊÄßÊ†º„Çø„Ç§„Éó„ÇíË©≥„Åó„ÅèÂàÜÊûê</p>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">üéØ</div>
                        <h3 class="font-semibold mb-2">ÈÅ©ÊÄß„Éû„ÉÉ„ÉÅ„É≥„Ç∞</h3>
                        <p class="text-sm text-gray-600">ËààÂë≥„Å®ËÉΩÂäõ„Å´ÊúÄÈÅ©„Å™Áøí„ÅÑ‰∫ã„ÇíÊèêÊ°à</p>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">üìä</div>
                        <h3 class="font-semibold mb-2">Ë©≥Á¥∞„É¨„Éù„Éº„Éà</h3>
                        <p class="text-sm text-gray-600">ÂÖ∑‰ΩìÁöÑ„Å™ÁêÜÁî±„Å®ÊïôÂÆ§ÊÉÖÂ†±„Çí„ÅäÂ±ä„Åë</p>
                    </div>
                </div>
                
                <button id="startBtn" class="btn btn-primary text-lg px-8 py-4">
                    <i class="fas fa-play"></i>
                    Ë®∫Êñ≠„ÇíÂßã„ÇÅ„ÇãÔºàÁÑ°ÊñôÔºâ
                </button>
                
                <p class="text-xs text-gray-500 mt-4">
                    ÊâÄË¶ÅÊôÇÈñìÔºöÁ¥Ñ3ÂàÜ | Ë®∫Êñ≠ÁµêÊûú„ÅØ‰øùÂ≠ò„Åï„Çå„Åæ„Åô
                </p>
            </div>
            
            <!-- Diagnostic Steps -->
            <div id="stepContainer" style="display: none;">
                <!-- Step 1: Basic Info -->
                <div id="step1" class="card fade-in step-content">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-user-circle text-blue-500 mr-3"></i>
                        Âü∫Êú¨ÊÉÖÂ†±„Çí„ÅäËÅû„Åã„Åõ„Åè„Å†„Åï„ÅÑ
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="form-group">
                            <label for="childName" class="form-label">
                                <i class="fas fa-child mr-2"></i>„ÅäÂ≠êÊßò„ÅÆ„ÅäÂêçÂâç
                            </label>
                            <input type="text" id="childName" class="form-input" 
                                   placeholder="‰æãÔºöÁî∞‰∏≠ Â§™ÈÉé" aria-describedby="childName-error">
                            <div id="childName-error" class="error-message" style="display: none;">
                                <i class="fas fa-exclamation-triangle"></i>
                                „ÅäÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="childAge" class="form-label">
                                <i class="fas fa-birthday-cake mr-2"></i>Âπ¥ÈΩ¢
                            </label>
                            <select id="childAge" class="form-input" aria-describedby="childAge-error">
                                <option value="">Âπ¥ÈΩ¢„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                <option value="3">3Ê≠≥</option>
                                <option value="4">4Ê≠≥</option>
                                <option value="5">5Ê≠≥</option>
                                <option value="6">6Ê≠≥</option>
                                <option value="7">7Ê≠≥</option>
                                <option value="8">8Ê≠≥</option>
                                <option value="9">9Ê≠≥</option>
                                <option value="10">10Ê≠≥</option>
                                <option value="11">11Ê≠≥</option>
                                <option value="12">12Ê≠≥</option>
                                <option value="13">13Ê≠≥</option>
                                <option value="14">14Ê≠≥</option>
                                <option value="15">15Ê≠≥</option>
                            </select>
                            <div id="childAge-error" class="error-message" style="display: none;">
                                <i class="fas fa-exclamation-triangle"></i>
                                Âπ¥ÈΩ¢„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="gender" class="form-label">
                                <i class="fas fa-venus-mars mr-2"></i>ÊÄßÂà•
                            </label>
                            <select id="gender" class="form-input">
                                <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                <option value="boy">Áî∑„ÅÆÂ≠ê</option>
                                <option value="girl">Â•≥„ÅÆÂ≠ê</option>
                                <option value="other">„Åù„ÅÆ‰ªñ„ÉªÁ≠î„Åà„Åü„Åè„Å™„ÅÑ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="budget" class="form-label">
                                <i class="fas fa-yen-sign mr-2"></i>ÊúàË¨ù„ÅÆ‰∫àÁÆó
                            </label>
                            <select id="budget" class="form-input" aria-describedby="budget-error">
                                <option value="">‰∫àÁÆó„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                <option value="5000">„Äú5,000ÂÜÜ</option>
                                <option value="10000">5,001„Äú10,000ÂÜÜ</option>
                                <option value="15000">10,001„Äú15,000ÂÜÜ</option>
                                <option value="20000">15,001„Äú20,000ÂÜÜ</option>
                                <option value="25000">20,001„Äú25,000ÂÜÜ</option>
                                <option value="30000">25,001ÂÜÜ„Äú</option>
                            </select>
                            <div id="budget-error" class="error-message" style="display: none;">
                                <i class="fas fa-exclamation-triangle"></i>
                                ‰∫àÁÆó„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end mt-8">
                        <button id="step1Next" class="btn btn-primary" disabled>
                            Ê¨°„Å∏ÈÄ≤„ÇÄ
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 2: Personality Type -->
                <div id="step2" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-brain text-purple-500 mr-3"></i>
                        ÊÄßÊ†º„Çø„Ç§„ÉóË®∫Êñ≠
                    </h2>
                    
                    <p class="text-gray-600 mb-8">
                        „ÅäÂ≠êÊßò„ÅÆÊÄßÊ†º„Å´ÊúÄ„ÇÇËøë„ÅÑ„ÇÇ„ÅÆ„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑ„ÄÇË§áÊï∞ÂΩì„Å¶„ÅØ„Åæ„ÇãÂ†¥Âêà„ÅØ„ÄÅ„Çà„ÇäÂº∑„ÅèÊÑü„Åò„Çã„ÇÇ„ÅÆ„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                    </p>
                    
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="personality" value="active">
                            <div class="radio-card">
                                <div class="radio-icon">‚ö°</div>
                                <div class="radio-content">
                                    <h3>„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Çø„Ç§„Éó</h3>
                                    <p>ÂÖÉÊ∞ó„ÅÑ„Å£„Å±„ÅÑ„ÄÅ‰Ωì„ÇíÂãï„Åã„Åô„ÅÆ„ÅåÂ§ßÂ•Ω„Åç</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="creative">
                            <div class="radio-card">
                                <div class="radio-icon">üé®</div>
                                <div class="radio-content">
                                    <h3>„ÇØ„É™„Ç®„Ç§„ÉÜ„Ç£„Éñ„Çø„Ç§„Éó</h3>
                                    <p>ÊÉ≥ÂÉèÂäõË±ä„Åã„ÄÅËá™Áî±„Å™Ë°®Áèæ„ÇíÂ•Ω„ÇÄ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="logical">
                            <div class="radio-card">
                                <div class="radio-icon">üßÆ</div>
                                <div class="radio-content">
                                    <h3>„É≠„Ç∏„Ç´„É´„Çø„Ç§„Éó</h3>
                                    <p>Ë´ñÁêÜÁöÑÊÄùËÄÉ„ÄÅÂïèÈ°åËß£Ê±∫„ÅåÂæóÊÑè</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="social">
                            <div class="radio-card">
                                <div class="radio-icon">üë•</div>
                                <div class="radio-content">
                                    <h3>„ÇΩ„Éº„Ç∑„É£„É´„Çø„Ç§„Éó</h3>
                                    <p>„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥ËÉΩÂäõ„ÅåÈ´ò„ÅÑ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="calm">
                            <div class="radio-card">
                                <div class="radio-icon">üå∏</div>
                                <div class="radio-content">
                                    <h3>Á©è„ÇÑ„Åã„Çø„Ç§„Éó</h3>
                                    <p>ËêΩ„Å°ÁùÄ„ÅÑ„Å¶„ÅÑ„Çã„ÄÅÈõÜ‰∏≠Âäõ„ÅåÈ´ò„ÅÑ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="personality" value="adventurous">
                            <div class="radio-card">
                                <div class="radio-icon">üó∫Ô∏è</div>
                                <div class="radio-content">
                                    <h3>ÂÜíÈô∫„Çø„Ç§„Éó</h3>
                                    <p>Êñ∞„Åó„ÅÑ„Åì„Å®„Å´ÊåëÊà¶„Åô„Çã„ÅÆ„ÅåÂ•Ω„Åç</p>
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step2Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            Êàª„Çã
                        </button>
                        <button id="step2Next" class="btn btn-primary" disabled>
                            Ê¨°„Å∏ÈÄ≤„ÇÄ
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 3: Interests -->
                <div id="step3" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-heart text-red-500 mr-3"></i>
                        ËààÂë≥„ÉªÈñ¢ÂøÉÂàÜÈáé
                    </h2>
                    
                    <p class="text-gray-600 mb-8">
                        „ÅäÂ≠êÊßò„ÅåËààÂë≥„ÇíÁ§∫„Åó„Å¶„ÅÑ„ÇãÂàÜÈáé„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºàË§áÊï∞ÈÅ∏ÊäûÂèØÔºâ
                    </p>
                    
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4" id="interestsContainer">
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="sports">
                            <div class="radio-card">
                                <div class="radio-icon">‚öΩ</div>
                                <div class="radio-content">
                                    <h3>„Çπ„Éù„Éº„ÉÑ</h3>
                                    <p>„Çµ„ÉÉ„Ç´„Éº„ÄÅÈáéÁêÉ„ÄÅÊ∞¥Ê≥≥„Å™„Å©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="music">
                            <div class="radio-card">
                                <div class="radio-icon">üéµ</div>
                                <div class="radio-content">
                                    <h3>Èü≥Ê•Ω</h3>
                                    <p>„Éî„Ç¢„Éé„ÄÅ„Éê„Ç§„Ç™„É™„É≥„ÄÅÊ≠å„Å™„Å©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="art">
                            <div class="radio-card">
                                <div class="radio-icon">üé®</div>
                                <div class="radio-content">
                                    <h3>„Ç¢„Éº„Éà</h3>
                                    <p>ÁµµÁîª„ÄÅÂ∑•‰Ωú„ÄÅ„Éá„Ç∂„Ç§„É≥„Å™„Å©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="language">
                            <div class="radio-card">
                                <div class="radio-icon">üó£Ô∏è</div>
                                <div class="radio-content">
                                    <h3>Ë®ÄË™û</h3>
                                    <p>Ëã±Ë™û„ÄÅ‰∏≠ÂõΩË™û„ÄÅÂõΩË™û„Å™„Å©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="science">
                            <div class="radio-card">
                                <div class="radio-icon">üî¨</div>
                                <div class="radio-content">
                                    <h3>ÁßëÂ≠¶„ÉªÁêÜÊï∞</h3>
                                    <p>ÂÆüÈ®ì„ÄÅÊï∞Â≠¶„ÄÅ„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞„Å™„Å©</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="interests" value="dance">
                            <div class="radio-card">
                                <div class="radio-icon">üíÉ</div>
                                <div class="radio-content">
                                    <h3>„ÉÄ„É≥„Çπ</h3>
                                    <p>„Éê„É¨„Ç®„ÄÅ„Éí„ÉÉ„Éó„Éõ„ÉÉ„Éó„ÄÅÊó•Ëàû„Å™„Å©</p>
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step3Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            Êàª„Çã
                        </button>
                        <button id="step3Next" class="btn btn-primary" disabled>
                            Ê¨°„Å∏ÈÄ≤„ÇÄ
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 4: Physical Activity Level -->
                <div id="step4" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-running text-green-500 mr-3"></i>
                        ‰ΩìÂäõ„ÉªÈÅãÂãï„É¨„Éô„É´
                    </h2>
                    
                    <p class="text-gray-600 mb-8">
                        „ÅäÂ≠êÊßò„ÅÆ‰ΩìÂäõ„ÇÑÈÅãÂãï„Å´ÂØæ„Åô„ÇãÂßøÂã¢„Å´„Å§„ÅÑ„Å¶Êïô„Åà„Å¶„Åè„Å†„Åï„ÅÑ
                    </p>
                    
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="activityLevel" value="high">
                            <div class="radio-card">
                                <div class="radio-icon">üèÉ‚Äç‚ôÇÔ∏è</div>
                                <div class="radio-content">
                                    <h3>„Å®„Å¶„ÇÇÊ¥ªÁô∫</h3>
                                    <p>‰ΩìÂäõ„Åå„ÅÇ„Çä„ÄÅÊøÄ„Åó„ÅÑÈÅãÂãï„ÇÇÂ•Ω„ÇÄ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="activityLevel" value="medium">
                            <div class="radio-card">
                                <div class="radio-icon">üö∂‚Äç‚ôÇÔ∏è</div>
                                <div class="radio-content">
                                    <h3>ÈÅ©Â∫¶„Å´Ê¥ªÁô∫</h3>
                                    <p>ÈÅãÂãï„ÅØÂ•Ω„Åç„Å†„Åå„ÄÅÁ®ã„Çà„ÅÑ„É¨„Éô„É´</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="activityLevel" value="low">
                            <div class="radio-card">
                                <div class="radio-icon">üìö</div>
                                <div class="radio-content">
                                    <h3>„Ç§„É≥„Éâ„Ç¢Ê¥æ</h3>
                                    <p>ÂÆ§ÂÜÖ„Åß„ÅÆÊ¥ªÂãï„ÇíÂ•Ω„ÇÄ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="radio" name="activityLevel" value="mixed">
                            <div class="radio-card">
                                <div class="radio-icon">‚öñÔ∏è</div>
                                <div class="radio-content">
                                    <h3>„Éê„É©„É≥„ÇπÂûã</h3>
                                    <p>ÈÅãÂãï„ÇÇÂãâÂº∑„ÇÇ„Éê„É©„É≥„Çπ„Çà„Åè</p>
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step4Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            Êàª„Çã
                        </button>
                        <button id="step4Next" class="btn btn-primary" disabled>
                            Ê¨°„Å∏ÈÄ≤„ÇÄ
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 5: Practical Considerations -->
                <div id="step5" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-car text-blue-500 mr-3"></i>
                        ÂÆüÁî®ÁöÑ„Å™Êù°‰ª∂
                    </h2>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-map-marker-alt mr-2"></i>ÈÄÅËøé„Å´„Å§„ÅÑ„Å¶
                            </label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="transportation" value="easy">
                                    <div class="radio-card">
                                        <div class="radio-icon">üöó</div>
                                        <div class="radio-content">
                                            <h3>ÈÄÅËøéÂèØËÉΩ</h3>
                                            <p>Ëªä„ÇÑÂÖ¨ÂÖ±‰∫§ÈÄöÊ©üÈñ¢„ÅßÈÄö„Åà„Çã</p>
                                        </div>
                                    </div>
                                </label>
                                
                                <label class="radio-option">
                                    <input type="radio" name="transportation" value="limited">
                                    <div class="radio-card">
                                        <div class="radio-icon">üöå</div>
                                        <div class="radio-content">
                                            <h3>Êù°‰ª∂‰ªò„Åç</h3>
                                            <p>ÊôÇÈñì„ÇÑÂ†¥ÊâÄ„Å´Âà∂Èôê„Åå„ÅÇ„Çã</p>
                                        </div>
                                    </div>
                                </label>
                                
                                <label class="radio-option">
                                    <input type="radio" name="transportation" value="difficult">
                                    <div class="radio-card">
                                        <div class="radio-icon">üè†</div>
                                        <div class="radio-content">
                                            <h3>Ëá™ÂÆÖËøë„Åè„ÅÆ„Åø</h3>
                                            <p>ÂæíÊ≠©ÂúèÂÜÖ„Åæ„Åü„ÅØ„Ç™„É≥„É©„Ç§„É≥</p>
                                        </div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-clock mr-2"></i>Â∏åÊúõ„Åô„ÇãÊôÇÈñìÂ∏Ø
                            </label>
                            <div class="space-y-2">
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="timeSlots" value="weekday_morning">
                                    <span>Âπ≥Êó•ÂçàÂâç</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="timeSlots" value="weekday_afternoon">
                                    <span>Âπ≥Êó•ÂçàÂæå</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="timeSlots" value="weekday_evening">
                                    <span>Âπ≥Êó•Â§ïÊñπ</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="timeSlots" value="weekend">
                                    <span>ÂúüÊó•Á•ùÊó•</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step5Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            Êàª„Çã
                        </button>
                        <button id="step5Next" class="btn btn-primary" disabled>
                            Ê¨°„Å∏ÈÄ≤„ÇÄ
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 6: Goals -->
                <div id="step6" class="card fade-in step-content" style="display: none;">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">
                        <i class="fas fa-target text-yellow-500 mr-3"></i>
                        Áøí„ÅÑ‰∫ã„Å∏„ÅÆÊúüÂæÖ„ÉªÁõÆÊ®ô
                    </h2>
                    
                    <p class="text-gray-600 mb-8">
                        Áøí„ÅÑ‰∫ã„ÇíÈÄö„Åò„Å¶„ÄÅ„ÅäÂ≠êÊßò„Å´„Å©„ÅÆ„Çà„ÅÜ„Å™ÊàêÈï∑„ÇíÊúüÂæÖ„Åó„Åæ„Åô„ÅãÔºüÔºàË§áÊï∞ÈÅ∏ÊäûÂèØÔºâ
                    </p>
                    
                    <div class="grid md:grid-cols-2 gap-4" id="goalsContainer">
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="skill_development">
                            <div class="radio-card">
                                <div class="radio-icon">üéØ</div>
                                <div class="radio-content">
                                    <h3>ÊäÄË°ìÁøíÂæó</h3>
                                    <p>Â∞ÇÈñÄÁöÑ„Å™„Çπ„Ç≠„É´„ÇíË∫´„Å´„Å§„Åë„Å¶„Åª„Åó„ÅÑ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="social_skills">
                            <div class="radio-card">
                                <div class="radio-icon">üë´</div>
                                <div class="radio-content">
                                    <h3>Á§æ‰ºöÊÄßÂêë‰∏ä</h3>
                                    <p>ÂèãÈÅî„Å®„ÅÆÈñ¢„Çè„Çä„ÇÑ„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="confidence">
                            <div class="radio-card">
                                <div class="radio-icon">üí™</div>
                                <div class="radio-content">
                                    <h3>Ëá™‰ø°„ÅÆÂêë‰∏ä</h3>
                                    <p>ÈÅîÊàêÊÑü„ÇíÈÄö„Åò„Å¶Ëá™‰ø°„Çí„Å§„Åë„Å¶„Åª„Åó„ÅÑ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="creativity">
                            <div class="radio-card">
                                <div class="radio-icon">‚ú®</div>
                                <div class="radio-content">
                                    <h3>ÂâµÈÄ†ÊÄß„ÅÆÁô∫ÈÅî</h3>
                                    <p>ÊÉ≥ÂÉèÂäõ„ÇÑË°®ÁèæÂäõ„Çí‰º∏„Å∞„Åó„Åü„ÅÑ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="discipline">
                            <div class="radio-card">
                                <div class="radio-icon">üìù</div>
                                <div class="radio-content">
                                    <h3>Ë¶èÂæã„ÉªÈõÜ‰∏≠Âäõ</h3>
                                    <p>Á∂ôÁ∂ö„Åô„ÇãÂäõ„ÇÑÈõÜ‰∏≠Âäõ„ÇíË∫´„Å´„Å§„Åë„Åü„ÅÑ</p>
                                </div>
                            </div>
                        </label>
                        
                        <label class="radio-option">
                            <input type="checkbox" name="goals" value="fun">
                            <div class="radio-card">
                                <div class="radio-icon">üòä</div>
                                <div class="radio-content">
                                    <h3>Ê•Ω„Åó„ÅÑÊôÇÈñì</h3>
                                    <p>„Åæ„Åö„ÅØÊ•Ω„Åó„ÅèÈÅé„Åî„Åó„Å¶„Åª„Åó„ÅÑ</p>
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button id="step6Back" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i>
                            Êàª„Çã
                        </button>
                        <button id="step6Submit" class="btn btn-primary" disabled>
                            <i class="fas fa-calculator"></i>
                            Ë®∫Êñ≠ÁµêÊûú„ÇíË¶ã„Çã
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Loading Screen -->
            <div id="loadingScreen" class="card text-center" style="display: none;">
                <div class="spinner mb-4"></div>
                <h2 class="text-xl font-semibold mb-2">Ë®∫Êñ≠ÁµêÊûú„ÇíÂàÜÊûê„Åó„Å¶„ÅÑ„Åæ„Åô...</h2>
                <p class="text-gray-600" id="loadingText">ÊÄßÊ†º„Çø„Ç§„Éó„ÇíÂàÜÊûê‰∏≠</p>
                <div class="mt-6">
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="analysisProgress" class="bg-blue-500 h-2 rounded-full transition-all duration-1000" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <!-- Results Screen -->
            <div id="resultsScreen" class="fade-in" style="display: none;">
                <!-- Personal Report Card -->
                <div class="card mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-user-graduate text-blue-500 mr-3"></i>
                            <span id="childNameDisplay"></span>„Åï„Çì„ÅÆË®∫Êñ≠ÁµêÊûú
                        </h2>
                        <div class="flex gap-2 no-print">
                            <button id="shareBtn" class="btn btn-secondary">
                                <i class="fas fa-share-alt"></i>
                                „Ç∑„Çß„Ç¢
                            </button>
                            <button id="printBtn" class="btn btn-secondary">
                                <i class="fas fa-print"></i>
                                Âç∞Âà∑
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg">
                            <h3 class="font-semibold mb-3">
                                <i class="fas fa-brain text-purple-500 mr-2"></i>
                                ÊÄßÊ†º„Çø„Ç§„Éó
                            </h3>
                            <div id="personalityResult" class="text-lg font-medium"></div>
                            <div id="personalityDescription" class="text-sm text-gray-600 mt-2"></div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                            <h3 class="font-semibold mb-3">
                                <i class="fas fa-chart-pie text-green-500 mr-2"></i>
                                ÈÅ©ÊÄß„Çπ„Ç≥„Ç¢ÂàÜÂ∏É
                            </h3>
                            <canvas id="aptitudeChart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Top 3 Recommendations -->
                <div id="recommendationsContainer">
                    <!-- Dynamic content will be inserted here -->
                </div>
                
                <!-- Cost Simulator -->
                <div class="card">
                    <h3 class="text-xl font-semibold mb-4">
                        <i class="fas fa-calculator text-green-500 mr-2"></i>
                        Ë≤ªÁî®„Ç∑„Éü„É•„É¨„Éº„Çø„Éº
                    </h3>
                    <div id="costSimulator" class="grid md:grid-cols-3 gap-4">
                        <!-- Dynamic content -->
                    </div>
                </div>
                
                <!-- Parental Advice -->
                <div class="card">
                    <h3 class="text-xl font-semibold mb-4">
                        <i class="fas fa-heart text-red-500 mr-2"></i>
                        ‰øùË≠∑ËÄÖ„ÅÆÊñπ„Å∏„ÅÆ„Ç¢„Éâ„Éê„Ç§„Çπ
                    </h3>
                    <div id="parentalAdvice" class="space-y-4">
                        <!-- Dynamic content -->
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="card text-center no-print">
                    <div class="flex flex-wrap justify-center gap-4">
                        <button id="newDiagnosisBtn" class="btn btn-primary">
                            <i class="fas fa-redo"></i>
                            Êñ∞„Åó„ÅÑË®∫Êñ≠„ÇíÂßã„ÇÅ„Çã
                        </button>
                        <button id="compareBtn" class="btn btn-secondary">
                            <i class="fas fa-users"></i>
                            ÂèãÈÅî„Å®ÊØîËºÉ
                        </button>
                        <button id="saveResultBtn" class="btn btn-secondary">
                            <i class="fas fa-save"></i>
                            ÁµêÊûú„Çí‰øùÂ≠ò
                        </button>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-8 mt-16 no-print">
            <div class="max-w-4xl mx-auto px-4">
                <div class="grid md:grid-cols-3 gap-8">
                    <div>
                        <h3 class="font-semibold mb-4">Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠ Pro</h3>
                        <p class="text-sm text-gray-300">
                            ÁßëÂ≠¶ÁöÑ„Ç¢„Éó„É≠„Éº„ÉÅ„Åß„ÅäÂ≠êÊßò„ÅÆÂèØËÉΩÊÄß„ÇíÁô∫Ë¶ã„Åó„ÄÅÊúÄÈÅ©„Å™Áøí„ÅÑ‰∫ã„Çí„ÅîÊèêÊ°à„Åó„Åæ„Åô„ÄÇ
                        </p>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-4">„É™„É≥„ÇØ</h3>
                        <ul class="space-y-2 text-sm">
                            <li><a href="#privacy" class="text-gray-300 hover:text-white">„Éó„É©„Ç§„Éê„Ç∑„Éº„Éù„É™„Ç∑„Éº</a></li>
                            <li><a href="#terms" class="text-gray-300 hover:text-white">Âà©Áî®Ë¶èÁ¥Ñ</a></li>
                            <li><a href="#contact" class="text-gray-300 hover:text-white">„ÅäÂïè„ÅÑÂêà„Çè„Åõ</a></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-semibold mb-4">„Éï„Ç©„É≠„Éº„Åô„Çã</h3>
                        <div class="flex gap-4">
                            <a href="https://x.com/appadaycreator" class="text-gray-300 hover:text-white">
                                <i class="fab fa-twitter text-xl"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="border-t border-gray-700 mt-8 pt-8 text-center text-sm text-gray-400">
                    <p>&copy; 2025 App a Day Creator. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- Share Modal -->
    <div id="shareModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-xl p-6 m-4 max-w-md w-full">
            <h3 class="text-lg font-semibold mb-4">ÁµêÊûú„Çí„Ç∑„Çß„Ç¢</h3>
            <div class="space-y-3">
                <button class="w-full btn btn-primary" onclick="shareToTwitter()">
                    <i class="fab fa-twitter"></i>
                    Twitter„Åß„Ç∑„Çß„Ç¢
                </button>
                <button class="w-full btn btn-secondary" onclick="copyToClipboard()">
                    <i class="fas fa-copy"></i>
                    URL„Çí„Ç≥„Éî„Éº
                </button>
                <button class="w-full btn btn-secondary" onclick="closeShareModal()">
                    <i class="fas fa-times"></i>
                    Èñâ„Åò„Çã
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // Configuration & Data Management
        // ============================================
        
        const AppConfig = {
            // Activity database with detailed information
            activities: {
                programming: {
                    name: '„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞ÊïôÂÆ§',
                    icon: 'üíª',
                    category: 'STEM',
                    description: '„É≠„Ç∏„Ç´„É´„Ç∑„É≥„Ç≠„É≥„Ç∞„Å®ÂâµÈÄ†ÊÄß„ÇíËÇ≤„ÇÄ',
                    ageRange: [6, 15],
                    cost: { min: 8000, max: 20000 },
                    personality: ['logical', 'creative', 'calm'],
                    interests: ['science'],
                    activityLevel: ['low', 'medium'],
                    skills: ['Ë´ñÁêÜÁöÑÊÄùËÄÉ', 'ÂïèÈ°åËß£Ê±∫Âäõ', 'ÂâµÈÄ†ÊÄß'],
                    benefits: 'Â∞ÜÊù•„ÅÆ„Éá„Ç∏„Çø„É´Á§æ‰ºö„ÅßÊ¥ªË∫ç„Åô„ÇãÂü∫Á§é„ÇíË∫´„Å´„Å§„Åë„Çâ„Çå„Åæ„Åô',
                    affiliateUrl: 'https://example.com/programming'
                },
                english: {
                    name: 'Ëã±‰ºöË©±„Çπ„ÇØ„Éº„É´',
                    icon: 'üó£Ô∏è',
                    category: 'Ë™ûÂ≠¶',
                    description: '„Ç∞„É≠„Éº„Éê„É´Á§æ‰ºö„ÅßÊ¥ªË∫ç„Åô„ÇãË™ûÂ≠¶Âäõ„ÇíËÇ≤Êàê',
                    ageRange: [3, 15],
                    cost: { min: 6000, max: 15000 },
                    personality: ['social', 'adventurous'],
                    interests: ['language'],
                    activityLevel: ['low', 'medium', 'high'],
                    skills: ['„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥Âäõ', 'ÂõΩÈöõÊÑüË¶ö', 'Ë°®ÁèæÂäõ'],
                    benefits: 'ÂõΩÈöõÁöÑ„Å™Ë¶ñÈáé„ÇíÂ∫É„Åí„ÄÅÂ∞ÜÊù•„ÅÆÂèØËÉΩÊÄß„ÇíÊã°„Åí„Åæ„Åô',
                    affiliateUrl: 'https://example.com/english'
                },
                soccer: {
                    name: '„Çµ„ÉÉ„Ç´„Éº„ÇØ„É©„Éñ',
                    icon: '‚öΩ',
                    category: '„Çπ„Éù„Éº„ÉÑ',
                    description: '„ÉÅ„Éº„É†„ÉØ„Éº„ÇØ„Å®‰ΩìÂäõ„ÇíÂêåÊôÇ„Å´ËÇ≤„ÇÄ',
                    ageRange: [4, 15],
                    cost: { min: 5000, max: 12000 },
                    personality: ['active', 'social'],
                    interests: ['sports'],
                    activityLevel: ['high', 'medium'],
                    skills: ['‰ΩìÂäõÂêë‰∏ä', '„ÉÅ„Éº„É†„ÉØ„Éº„ÇØ', 'Áû¨Áô∫Âäõ'],
                    benefits: '‰ª≤Èñì„Å®ÂçîÂäõ„Åô„ÇãÂñú„Å≥„Å®ÂÅ•Â∫∑„Å™‰Ωì„Å•„Åè„Çä„Åå„Åß„Åç„Åæ„Åô',
                    affiliateUrl: 'https://example.com/soccer'
                },
                piano: {
                    name: '„Éî„Ç¢„ÉéÊïôÂÆ§',
                    icon: 'üéπ',
                    category: 'Èü≥Ê•Ω',
                    description: 'Èü≥ÊÑü„Å®Ë°®ÁèæÂäõ„ÇíË±ä„Åã„Å´ËÇ≤„ÇÄ',
                    ageRange: [3, 15],
                    cost: { min: 7000, max: 18000 },
                    personality: ['calm', 'creative'],
                    interests: ['music'],
                    activityLevel: ['low', 'medium'],
                    skills: ['Èü≥ÊÑü', 'ÈõÜ‰∏≠Âäõ', 'Ë°®ÁèæÂäõ'],
                    benefits: 'ÊÑüÊÄß„ÇíË±ä„Åã„Å´„Åó„ÄÅÁ∂ôÁ∂ö„Åô„ÇãÂäõ„ÇíË∫´„Å´„Å§„Åë„Çâ„Çå„Åæ„Åô',
                    affiliateUrl: 'https://example.com/piano'
                },
                swimming: {
                    name: 'Ê∞¥Ê≥≥ÊïôÂÆ§',
                    icon: 'üèä',
                    category: '„Çπ„Éù„Éº„ÉÑ',
                    description: 'ÂÖ®Ë∫´ÈÅãÂãï„ÅßÂü∫Á§é‰ΩìÂäõ„ÇíÂêë‰∏ä',
                    ageRange: [3, 15],
                    cost: { min: 6000, max: 10000 },
                    personality: ['active', 'calm'],
                    interests: ['sports'],
                    activityLevel: ['high', 'medium'],
                    skills: ['‰ΩìÂäõÂêë‰∏ä', 'ÂøÉËÇ∫Ê©üËÉΩ', 'Á∂ôÁ∂öÂäõ'],
                    benefits: 'ÁîüÊ∂Ø„Å´„Çè„Åü„Å£„Å¶ÂΩπÁ´ã„Å§ÊäÄË°ì„Å®‰∏àÂ§´„Å™‰Ωì„Å•„Åè„Çä„Åå„Åß„Åç„Åæ„Åô',
                    affiliateUrl: 'https://example.com/swimming'
                },
                art: {
                    name: 'ÁµµÁîªÊïôÂÆ§',
                    icon: 'üé®',
                    category: '„Ç¢„Éº„Éà',
                    description: 'ÂâµÈÄ†ÊÄß„Å®ÊÑüÊÄß„ÇíËá™Áî±„Å´Ë°®Áèæ',
                    ageRange: [3, 15],
                    cost: { min: 5000, max: 12000 },
                    personality: ['creative', 'calm'],
                    interests: ['art'],
                    activityLevel: ['low'],
                    skills: ['ÂâµÈÄ†ÊÄß', 'ÈõÜ‰∏≠Âäõ', 'Ë°®ÁèæÂäõ'],
                    benefits: 'Ëá™Áî±„Å™Áô∫ÊÉ≥Âäõ„Å®ÁæéÁöÑ„Çª„É≥„Çπ„ÇíËÇ≤„Å¶„Çâ„Çå„Åæ„Åô',
                    affiliateUrl: 'https://example.com/art'
                },
                dance: {
                    name: '„ÉÄ„É≥„Çπ„Çπ„ÇØ„Éº„É´',
                    icon: 'üíÉ',
                    category: 'Ë°®Áèæ„ÉªÈÅãÂãï',
                    description: '„É™„Ç∫„É†ÊÑü„Å®Ë°®ÁèæÂäõ„ÇíË∫´„Å´„Å§„Åë„Çã',
                    ageRange: [3, 15],
                    cost: { min: 6000, max: 15000 },
                    personality: ['active', 'creative', 'social'],
                    interests: ['dance', 'music'],
                    activityLevel: ['high', 'medium'],
                    skills: ['„É™„Ç∫„É†ÊÑü', 'Ë°®ÁèæÂäõ', '‰ΩìÂäõÂêë‰∏ä'],
                    benefits: 'Èü≥Ê•Ω„Å´Âêà„Çè„Åõ„Å¶‰Ωì„ÇíÂãï„Åã„ÅôÊ•Ω„Åó„Åï„ÇíÂ≠¶„Åπ„Åæ„Åô',
                    affiliateUrl: 'https://example.com/dance'
                },
                martial_arts: {
                    name: 'Ê≠¶ÈÅìÊïôÂÆ§',
                    icon: 'ü•ã',
                    category: '„Çπ„Éù„Éº„ÉÑ„ÉªÁ≤æÁ•û',
                    description: 'Á§ºÂÑÄ„Å®Á≤æÁ•ûÂäõ„ÇíÈçõ„Åà„Çã',
                    ageRange: [5, 15],
                    cost: { min: 5000, max: 12000 },
                    personality: ['calm', 'active'],
                    interests: ['sports'],
                    activityLevel: ['high', 'medium'],
                    skills: ['Á§ºÂÑÄ', 'Á≤æÁ•ûÂäõ', '‰ΩìÂäõÂêë‰∏ä'],
                    benefits: 'ÂøÉ„Å®‰Ωì„ÅÆ‰∏°Êñπ„ÇíÈçõ„Åà„ÄÅÁ§ºÂÑÄÊ≠£„Åó„Åï„ÇíË∫´„Å´„Å§„Åë„Çâ„Çå„Åæ„Åô',
                    affiliateUrl: 'https://example.com/martial-arts'
                }
            },
            
            // Personality type definitions
            personalityTypes: {
                active: {
                    name: '„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Çø„Ç§„Éó',
                    icon: '‚ö°',
                    description: '„Ç®„Éç„É´„ÇÆ„ÉÉ„Ç∑„É•„Åß‰Ωì„ÇíÂãï„Åã„Åô„Åì„Å®„ÅåÂ§ßÂ•Ω„Åç„ÄÇ„Çπ„Éù„Éº„ÉÑ„ÇÑÂ§ñ„Åß„ÅÆÊ¥ªÂãï„ÇíÈÄö„Åò„Å¶ÊàêÈï∑„Åó„Åæ„Åô„ÄÇ',
                    strengths: ['‰ΩìÂäõ„Åå„ÅÇ„Çã', 'Á©çÊ•µÁöÑ', '„ÉÅ„É£„É¨„É≥„Ç∏Á≤æÁ•ûÊó∫Áõõ'],
                    recommendations: ['‰Ωì„Çí‰Ωø„ÅÜÁøí„ÅÑ‰∫ã', '„ÉÅ„Éº„É†Ê¥ªÂãï', 'Á´∂ÊäÄÊÄß„ÅÆ„ÅÇ„Çã„ÇÇ„ÅÆ']
                },
                creative: {
                    name: '„ÇØ„É™„Ç®„Ç§„ÉÜ„Ç£„Éñ„Çø„Ç§„Éó',
                    icon: 'üé®',
                    description: 'ÊÉ≥ÂÉèÂäõË±ä„Åã„ÅßËá™Áî±„Å™Ë°®Áèæ„ÇíÂ•Ω„Åø„Åæ„Åô„ÄÇ„Ç¢„Éº„Éà„ÇÑÈü≥Ê•Ω„ÅßÊâçËÉΩ„ÇíÁô∫ÊèÆ„Åó„Åæ„Åô„ÄÇ',
                    strengths: ['ÊÉ≥ÂÉèÂäõ„ÅåË±ä„Åã', 'ÊÑüÊÄß„ÅåÈã≠„ÅÑ', 'Áã¨ÂâµÁöÑ'],
                    recommendations: ['Ëä∏Ë°ìÁ≥ª„ÅÆÁøí„ÅÑ‰∫ã', 'Ëá™Áî±Â∫¶„ÅÆÈ´ò„ÅÑÊ¥ªÂãï', 'Ë°®ÁèæÈáçË¶ñ„ÅÆ„ÇÇ„ÅÆ']
                },
                logical: {
                    name: '„É≠„Ç∏„Ç´„É´„Çø„Ç§„Éó',
                    icon: 'üßÆ',
                    description: 'Áâ©‰∫ã„ÇíË´ñÁêÜÁöÑ„Å´ËÄÉ„Åà„Çã„ÅÆ„ÅåÂæóÊÑè„ÄÇSTEMÂàÜÈáé„ÅßÂäõ„ÇíÁô∫ÊèÆ„Åó„Åæ„Åô„ÄÇ',
                    strengths: ['Ë´ñÁêÜÁöÑÊÄùËÄÉ', 'ÂàÜÊûêÂäõ', 'ÈõÜ‰∏≠Âäõ'],
                    recommendations: ['„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞', 'ÁßëÂ≠¶ÂÆüÈ®ì', 'Êï∞Â≠¶ÁöÑÊÄùËÄÉ„Çí‰Ωø„ÅÜÁøí„ÅÑ‰∫ã']
                },
                social: {
                    name: '„ÇΩ„Éº„Ç∑„É£„É´„Çø„Ç§„Éó',
                    icon: 'üë•',
                    description: '„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥ËÉΩÂäõ„ÅåÈ´ò„Åè„ÄÅ‰∫∫„Å®„ÅÆÈñ¢„Çè„Çä„ÇíÂ§ßÂàá„Å´„Åó„Åæ„Åô„ÄÇ',
                    strengths: ['„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥Âäõ', 'ÂçîË™øÊÄß', '„É™„Éº„ÉÄ„Éº„Ç∑„ÉÉ„Éó'],
                    recommendations: ['„ÉÅ„Éº„É†Ê¥ªÂãï', 'Áô∫Ë°®„ÅÆÊ©ü‰ºö„Åå„ÅÇ„ÇãÁøí„ÅÑ‰∫ã', '‰∫∫„Å®Èñ¢„Çè„ÇãÊ¥ªÂãï']
                },
                calm: {
                    name: 'Á©è„ÇÑ„Åã„Çø„Ç§„Éó',
                    icon: 'üå∏',
                    description: 'ËêΩ„Å°ÁùÄ„ÅÑ„Å¶„ÅÑ„Å¶ÈõÜ‰∏≠Âäõ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åò„Å£„Åè„Çä„Å®Âèñ„ÇäÁµÑ„ÇÄÊ¥ªÂãï„ÅåÂêë„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇ',
                    strengths: ['ÈõÜ‰∏≠Âäõ', 'Á∂ôÁ∂öÂäõ', 'ÂøçËÄêÂäõ'],
                    recommendations: ['ÂÄã‰∫∫ÊäÄ„ÇíÁ£®„ÅèÁøí„ÅÑ‰∫ã', 'ÈõÜ‰∏≠„ÇíË¶Å„Åô„ÇãÊ¥ªÂãï', 'Á∂ôÁ∂öÊÄßÈáçË¶ñ„ÅÆ„ÇÇ„ÅÆ']
                },
                adventurous: {
                    name: 'ÂÜíÈô∫„Çø„Ç§„Éó',
                    icon: 'üó∫Ô∏è',
                    description: 'Êñ∞„Åó„ÅÑ„Åì„Å®„Å´ÊåëÊà¶„Åô„Çã„ÅÆ„ÅåÂ•Ω„Åç„Åß„ÄÅÂ•ΩÂ•áÂøÉÊó∫Áõõ„Åß„Åô„ÄÇ',
                    strengths: ['Â•ΩÂ•áÂøÉÊó∫Áõõ', '„ÉÅ„É£„É¨„É≥„Ç∏Á≤æÁ•û', 'ÈÅ©ÂøúÂäõ'],
                    recommendations: ['Êñ∞„Åó„ÅÑÂàÜÈáé„ÅÆÁøí„ÅÑ‰∫ã', 'Â§âÂåñ„ÅÆ„ÅÇ„ÇãÊ¥ªÂãï', 'Êé¢Ê±ÇË¶ÅÁ¥†„ÅÆ„ÅÇ„Çã„ÇÇ„ÅÆ']
                }
            }
        };
        
        // ============================================
        // State Management
        // ============================================
        
        class AppState {
            constructor() {
                this.currentStep = 0;
                this.maxSteps = 6;
                this.formData = {};
                this.results = null;
                this.history = [];
                this.loadFromStorage();
            }
            
            updateFormData(key, value) {
                this.formData[key] = value;
                this.saveToStorage();
                this.validateCurrentStep();
            }
            
            validateCurrentStep() {
                const stepValidations = {
                    1: () => this.formData.childName && this.formData.childAge && this.formData.budget,
                    2: () => this.formData.personality,
                    3: () => this.formData.interests && this.formData.interests.length > 0,
                    4: () => this.formData.activityLevel,
                    5: () => this.formData.transportation,
                    6: () => this.formData.goals && this.formData.goals.length > 0
                };
                
                const isValid = stepValidations[this.currentStep] ? stepValidations[this.currentStep]() : false;
                const nextBtn = document.querySelector(`#step${this.currentStep}Next, #step${this.currentStep}Submit`);
                if (nextBtn) {
                    nextBtn.disabled = !isValid;
                }
                
                return isValid;
            }
            
            saveToStorage() {
                try {
                    localStorage.setItem('kidActivityFinderState', JSON.stringify({
                        formData: this.formData,
                        history: this.history
                    }));
                } catch (e) {
                    console.warn('Failed to save to localStorage:', e);
                }
            }
            
            loadFromStorage() {
                try {
                    const saved = localStorage.getItem('kidActivityFinderState');
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.formData = data.formData || {};
                        this.history = data.history || [];
                    }
                } catch (e) {
                    console.warn('Failed to load from localStorage:', e);
                }
            }
            
            saveResult(result) {
                const resultWithTimestamp = {
                    ...result,
                    timestamp: new Date().toISOString(),
                    id: Date.now()
                };
                this.history.unshift(resultWithTimestamp);
                // Keep only last 10 results
                this.history = this.history.slice(0, 10);
                this.saveToStorage();
            }
        }
        
        // Global state instance
        const state = new AppState();
        
        // ============================================
        // Diagnostic Engine
        // ============================================
        
        class DiagnosticEngine {
            static calculateScores(formData) {
                const scores = {};
                
                // Initialize scores for all activities
                Object.keys(AppConfig.activities).forEach(key => {
                    scores[key] = 0;
                });
                
                // Age compatibility scoring
                Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                    const age = parseInt(formData.childAge);
                    const [minAge, maxAge] = activity.ageRange;
                    
                    if (age >= minAge && age <= maxAge) {
                        scores[key] += 20; // Base age compatibility bonus
                        
                        // Optimal age range bonus
                        const optimalRange = maxAge - minAge;
                        const agePosition = (age - minAge) / optimalRange;
                        if (agePosition >= 0.2 && agePosition <= 0.8) {
                            scores[key] += 10; // In optimal range
                        }
                    } else {
                        scores[key] -= 20; // Age incompatibility penalty
                    }
                });
                
                // Personality type scoring
                if (formData.personality) {
                    Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                        if (activity.personality.includes(formData.personality)) {
                            scores[key] += 25; // Strong personality match
                        }
                    });
                }
                
                // Interest-based scoring
                if (formData.interests) {
                    formData.interests.forEach(interest => {
                        Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                            if (activity.interests.includes(interest)) {
                                scores[key] += 20; // Interest match
                            }
                        });
                    });
                }
                
                // Activity level scoring
                if (formData.activityLevel) {
                    Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                        if (activity.activityLevel.includes(formData.activityLevel)) {
                            scores[key] += 15; // Activity level match
                        }
                    });
                }
                
                // Budget compatibility
                if (formData.budget) {
                    const budget = parseInt(formData.budget);
                    Object.entries(AppConfig.activities).forEach(([key, activity]) => {
                        if (budget >= activity.cost.min) {
                            scores[key] += 10; // Can afford minimum
                            if (budget >= activity.cost.max) {
                                scores[key] += 5; // Can afford premium
                            }
                        } else {
                            scores[key] -= 15; // Budget constraint
                        }
                    });
                }
                
                // Goals alignment
                if (formData.goals) {
                    const goalActivities = {
                        skill_development: ['programming', 'piano', 'martial_arts'],
                        social_skills: ['soccer', 'dance', 'english'],
                        confidence: ['martial_arts', 'dance', 'swimming'],
                        creativity: ['art', 'piano', 'dance'],
                        discipline: ['piano', 'martial_arts', 'programming'],
                        fun: ['soccer', 'dance', 'swimming']
                    };
                    
                    formData.goals.forEach(goal => {
                        if (goalActivities[goal]) {
                            goalActivities[goal].forEach(activityKey => {
                                if (scores[activityKey] !== undefined) {
                                    scores[activityKey] += 15;
                                }
                            });
                        }
                    });
                }
                
                return scores;
            }
            
            static generateRecommendations(formData) {
                const scores = this.calculateScores(formData);
                
                // Sort activities by score
                const sortedActivities = Object.entries(scores)
                    .map(([key, score]) => ({
                        key,
                        activity: AppConfig.activities[key],
                        score: Math.max(0, score), // Ensure non-negative scores
                        compatibility: this.calculateCompatibility(score)
                    }))
                    .sort((a, b) => b.score - a.score);
                
                // Get top 3 recommendations
                const topRecommendations = sortedActivities.slice(0, 3);
                
                return {
                    recommendations: topRecommendations,
                    personalityType: AppConfig.personalityTypes[formData.personality],
                    allScores: scores,
                    formData
                };
            }
            
            static calculateCompatibility(score) {
                if (score >= 80) return { level: 'excellent', text: 'ÈùûÂ∏∏„Å´ÈÅ©„Åó„Å¶„ÅÑ„Çã', color: 'green' };
                if (score >= 60) return { level: 'good', text: 'ÈÅ©„Åó„Å¶„ÅÑ„Çã', color: 'blue' };
                if (score >= 40) return { level: 'moderate', text: '„Åæ„ÅÇ„Åæ„ÅÇÈÅ©„Åó„Å¶„ÅÑ„Çã', color: 'yellow' };
                return { level: 'low', text: '„ÅÇ„Åæ„ÇäÈÅ©„Åó„Å¶„ÅÑ„Å™„ÅÑ', color: 'red' };
            }
        }
        
        // ============================================
        // UI Components
        // ============================================
        
        class UIManager {
            static showStep(stepNumber) {
                // Hide all steps
                document.querySelectorAll('.step-content').forEach(step => {
                    step.style.display = 'none';
                });
                
                // Show target step
                const targetStep = document.getElementById(`step${stepNumber}`);
                if (targetStep) {
                    targetStep.style.display = 'block';
                    targetStep.classList.add('fade-in');
                }
                
                // Update progress
                this.updateProgress(stepNumber - 1, state.maxSteps);
                
                // Show/hide progress bar
                const progressContainer = document.getElementById('progressContainer');
                if (stepNumber > 0) {
                    progressContainer.style.display = 'block';
                } else {
                    progressContainer.style.display = 'none';
                }
                
                state.currentStep = stepNumber;
            }
            
            static updateProgress(current, total) {
                const percentage = (current / total) * 100;
                const progressFill = document.getElementById('progressFill');
                const progressText = document.getElementById('progressText');
                
                if (progressFill) {
                    progressFill.style.width = `${percentage}%`;
                }
                
                if (progressText) {
                    progressText.textContent = `${current}/${total}`;
                }
            }
            
            static showLoading() {
                document.getElementById('stepContainer').style.display = 'none';
                document.getElementById('loadingScreen').style.display = 'block';
                
                const messages = [
                    'ÊÄßÊ†º„Çø„Ç§„Éó„ÇíÂàÜÊûê‰∏≠',
                    'ËààÂë≥Èñ¢ÂøÉ„ÇíË©ï‰æ°‰∏≠',
                    'ÈÅ©ÊÄß„Éû„ÉÉ„ÉÅ„É≥„Ç∞„ÇíÂÆüË°å‰∏≠',
                    'ÊúÄÈÅ©„Å™Áøí„ÅÑ‰∫ã„ÇíÈÅ∏ÂÆö‰∏≠',
                    'Ë®∫Êñ≠ÁµêÊûú„ÇíÊ∫ñÂÇô‰∏≠'
                ];
                
                let messageIndex = 0;
                let progress = 0;
                
                const interval = setInterval(() => {
                    const loadingText = document.getElementById('loadingText');
                    const analysisProgress = document.getElementById('analysisProgress');
                    
                    if (loadingText && messageIndex < messages.length) {
                        loadingText.textContent = messages[messageIndex];
                        messageIndex++;
                    }
                    
                    progress += 20;
                    if (analysisProgress) {
                        analysisProgress.style.width = `${progress}%`;
                    }
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => this.showResults(), 500);
                    }
                }, 800);
            }
            
            static showResults() {
                const results = DiagnosticEngine.generateRecommendations(state.formData);
                state.results = results;
                state.saveResult(results);
                
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('progressContainer').style.display = 'none';
                document.getElementById('resultsScreen').style.display = 'block';
                
                this.renderResults(results);
            }
            
            static renderResults(results) {
                // Update child name display
                const childNameDisplay = document.getElementById('childNameDisplay');
                if (childNameDisplay) {
                    childNameDisplay.textContent = results.formData.childName || '„ÅäÂ≠êÊßò';
                }
                
                // Render personality type
                this.renderPersonalityResult(results.personalityType);
                
                // Render aptitude chart
                this.renderAptitudeChart(results.allScores);
                
                // Render recommendations
                this.renderRecommendations(results.recommendations);
                
                // Render cost simulator
                this.renderCostSimulator(results.recommendations);
                
                // Render parental advice
                this.renderParentalAdvice(results);
            }
            
            static renderPersonalityResult(personalityType) {
                const personalityResult = document.getElementById('personalityResult');
                const personalityDescription = document.getElementById('personalityDescription');
                
                if (personalityResult && personalityType) {
                    personalityResult.innerHTML = `
                        <div class="flex items-center gap-2">
                            <span class="text-2xl">${personalityType.icon}</span>
                            <span>${personalityType.name}</span>
                        </div>
                    `;
                }
                
                if (personalityDescription && personalityType) {
                    personalityDescription.textContent = personalityType.description;
                }
            }
            
            static renderAptitudeChart(scores) {
                const ctx = document.getElementById('aptitudeChart');
                if (!ctx) return;
                
                const labels = Object.keys(scores).map(key => 
                    AppConfig.activities[key]?.name || key
                ).slice(0, 6); // Top 6 for readability
                
                const data = Object.values(scores).slice(0, 6);
                
                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'ÈÅ©ÊÄß„Çπ„Ç≥„Ç¢',
                            data: data,
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            borderColor: 'rgba(59, 130, 246, 0.8)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    stepSize: 20
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
            
            static renderRecommendations(recommendations) {
                const container = document.getElementById('recommendationsContainer');
                if (!container) return;
                
                container.innerHTML = recommendations.map((rec, index) => `
                    <div class="result-card">
                        <div class="result-rank">#${index + 1}</div>
                        <div class="grid md:grid-cols-3 gap-6">
                            <div class="md:col-span-2">
                                <div class="flex items-center gap-4 mb-4">
                                    <div class="text-4xl">${rec.activity.icon}</div>
                                    <div>
                                        <h3 class="text-xl font-bold text-gray-800">${rec.activity.name}</h3>
                                        <p class="text-gray-600">${rec.activity.category}</p>
                                    </div>
                                </div>
                                
                                <p class="text-gray-700 mb-4">${rec.activity.description}</p>
                                
                                <div class="mb-4">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="font-medium">ÈÅ©ÊÄßÂ∫¶:</span>
                                        <div class="flex-1 bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-1000" 
                                                 style="width: ${rec.score}%"></div>
                                        </div>
                                        <span class="text-sm font-medium text-${rec.compatibility.color}-600">
                                            ${rec.compatibility.text}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="grid md:grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <h4 class="font-medium mb-2">Ë∫´„Å´„Å§„Åè„Çπ„Ç≠„É´</h4>
                                        <ul class="text-sm space-y-1">
                                            ${rec.activity.skills.map(skill => `<li>‚Ä¢ ${skill}</li>`).join('')}
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 class="font-medium mb-2">Ë≤ªÁî®ÁõÆÂÆâ</h4>
                                        <p class="text-sm">ÊúàÈ°ç ${rec.activity.cost.min.toLocaleString()}ÂÜÜ„Äú${rec.activity.cost.max.toLocaleString()}ÂÜÜ</p>
                                        <p class="text-sm text-gray-600">Âπ¥ÈΩ¢: ${rec.activity.ageRange[0]}Ê≠≥„Äú${rec.activity.ageRange[1]}Ê≠≥</p>
                                    </div>
                                </div>
                                
                                <div class="bg-blue-50 p-4 rounded-lg mb-4">
                                    <h4 class="font-medium mb-2">ÊúüÂæÖ„Åß„Åç„ÇãÂäπÊûú</h4>
                                    <p class="text-sm text-gray-700">${rec.activity.benefits}</p>
                                </div>
                            </div>
                            
                            <div class="space-y-4">
                                <a href="${rec.activity.affiliateUrl}" target="_blank" rel="noopener noreferrer" 
                                   class="block btn btn-primary text-center w-full">
                                    <i class="fas fa-external-link-alt"></i>
                                    ÊïôÂÆ§„ÇíÊé¢„Åô
                                </a>
                                
                                <button class="btn btn-secondary w-full" onclick="shareActivity('${rec.key}')">
                                    <i class="fas fa-share-alt"></i>
                                    „Åì„ÅÆÁøí„ÅÑ‰∫ã„Çí„Ç∑„Çß„Ç¢
                                </button>
                                
                                <div class="text-xs text-gray-500 text-center">
                                    <i class="fas fa-info-circle"></i>
                                    ‰ΩìÈ®ì„É¨„ÉÉ„Çπ„É≥ÊÉÖÂ†±„ÇÇ„ÉÅ„Çß„ÉÉ„ÇØÔºÅ
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            static renderCostSimulator(recommendations) {
                const container = document.getElementById('costSimulator');
                if (!container) return;
                
                container.innerHTML = recommendations.map(rec => `
                    <div class="bg-white p-4 rounded-lg border border-gray-200">
                        <h4 class="font-medium mb-3">${rec.activity.name}</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>ÊúàË¨ù</span>
                                <span>${rec.activity.cost.min.toLocaleString()}„Äú${rec.activity.cost.max.toLocaleString()}ÂÜÜ</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Âπ¥ÈñìË≤ªÁî®</span>
                                <span>${(rec.activity.cost.min * 12).toLocaleString()}„Äú${(rec.activity.cost.max * 12).toLocaleString()}ÂÜÜ</span>
                            </div>
                            <div class="border-t pt-2 font-medium">
                                <div class="flex justify-between">
                                    <span>ÂÖ•‰ºöÈáëËæº„ÅøÊ¶ÇÁÆó</span>
                                    <span>${(rec.activity.cost.min * 12 + 10000).toLocaleString()}ÂÜÜ„Äú</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            static renderParentalAdvice(results) {
                const container = document.getElementById('parentalAdvice');
                if (!container) return;
                
                const personalityType = results.personalityType;
                const topActivity = results.recommendations[0];
                
                const advice = `
                    <div class="bg-gradient-to-r from-pink-50 to-purple-50 p-6 rounded-lg">
                        <h4 class="font-semibold mb-3">
                            <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
                            ${personalityType.name}„ÅÆ„ÅäÂ≠êÊßò„Å∏„ÅÆ„Ç¢„Éâ„Éê„Ç§„Çπ
                        </h4>
                        <p class="mb-4">${personalityType.description}</p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <h5 class="font-medium mb-2">Âº∑„Åø„ÇíÊ¥ª„Åã„Åô„Éù„Ç§„É≥„Éà</h5>
                                <ul class="text-sm space-y-1">
                                    ${personalityType.strengths.map(strength => `<li>‚Ä¢ ${strength}</li>`).join('')}
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-medium mb-2">Áøí„ÅÑ‰∫ãÈÅ∏„Å≥„ÅÆ„Éí„É≥„Éà</h5>
                                <ul class="text-sm space-y-1">
                                    ${personalityType.recommendations.map(rec => `<li>‚Ä¢ ${rec}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                        <h4 class="font-semibold mb-3">
                            <i class="fas fa-heart text-red-500 mr-2"></i>
                            ÊàêÂäü„ÅÆ„Åü„ÇÅ„ÅÆ„Çµ„Éù„Éº„ÉàÊñπÊ≥ï
                        </h4>
                        <div class="space-y-3 text-sm">
                            <div>
                                <strong>Á∂ôÁ∂ö„ÅÆ„Ç≥„ÉÑ:</strong> 
                                „ÅäÂ≠êÊßò„ÅÆÂ∞è„Åï„Å™ÊàêÈï∑„ÇÇË¶ãÈÄÉ„Åï„Åö„ÄÅÁ©çÊ•µÁöÑ„Å´Ë§í„ÇÅ„Å¶„ÅÇ„Åí„Åæ„Åó„Çá„ÅÜ„ÄÇÁøí„ÅÑ‰∫ã„Åß„ÅÆÊ•Ω„Åó„ÅÑÂá∫Êù•‰∫ã„ÇíËÅû„ÅÑ„Å¶‰∏ÄÁ∑í„Å´Âñú„Å∂„Åì„Å®„ÅåÂ§ßÂàá„Åß„Åô„ÄÇ
                            </div>
                            <div>
                                <strong>‰ΩìÈ®ì„É¨„ÉÉ„Çπ„É≥„ÅÆÊ¥ªÁî®:</strong> 
                                „Åæ„Åö„ÅØ‰ΩìÈ®ì„É¨„ÉÉ„Çπ„É≥„ÇíÂèó„Åë„Å¶„ÄÅ„ÅäÂ≠êÊßò„ÅÆÂèçÂøú„Çí„Çà„ÅèË¶≥ÂØü„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÂº∑Âà∂ÁöÑ„Å´Ê±∫„ÇÅ„Çã„ÅÆ„Åß„ÅØ„Å™„Åè„ÄÅ„ÅäÂ≠êÊßò„ÅÆÊÑèÊÄù„ÇíÂ∞äÈáç„Åô„Çã„Åì„Å®„ÅåÈáçË¶Å„Åß„Åô„ÄÇ
                            </div>
                            <div>
                                <strong>‰ªñ„ÅÆÁøí„ÅÑ‰∫ã„Å®„ÅÆ‰∏°Á´ã:</strong> 
                                „ÅäÂ≠êÊßò„ÅÆË≤†ÊãÖ„Å´„Å™„Çâ„Å™„ÅÑ„Çà„ÅÜ„ÄÅÈÄ±1Âõû„Åã„ÇâÂßã„ÇÅ„Å¶Âæê„ÄÖ„Å´ÊÖ£„Çå„Åï„Åõ„Å¶„ÅÇ„Åí„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇË§áÊï∞„ÅÆÁøí„ÅÑ‰∫ã„ÇíÊ§úË®é„Åô„ÇãÂ†¥Âêà„ÅØ„ÄÅ„Çπ„Ç±„Ç∏„É•„Éº„É´„Å´‰ΩôË£ï„ÇíÊåÅ„Åü„Åõ„Çã„Åì„Å®„ÇíÂøÉ„Åå„Åë„Åæ„Åó„Çá„ÅÜ„ÄÇ
                            </div>
                        </div>
                    </div>
                `;
                
                container.innerHTML = advice;
            }
            
            static showWelcome() {
                document.getElementById('welcomeScreen').style.display = 'block';
                document.getElementById('stepContainer').style.display = 'none';
                document.getElementById('resultsScreen').style.display = 'none';
                document.getElementById('progressContainer').style.display = 'none';
                state.currentStep = 0;
            }
        }
        
        // ============================================
        // Event Handlers
        // ============================================
        
        function validateInput(inputElement, errorElementId, validationFn, errorMessage) {
            const isValid = validationFn(inputElement.value);
            const errorElement = document.getElementById(errorElementId);
            
            if (isValid) {
                inputElement.classList.remove('error');
                if (errorElement) errorElement.style.display = 'none';
            } else {
                inputElement.classList.add('error');
                if (errorElement) {
                    errorElement.style.display = 'flex';
                    errorElement.textContent = errorMessage;
                }
            }
            
            return isValid;
        }
        
        function setupValidation() {
            // Child name validation
            const childNameInput = document.getElementById('childName');
            if (childNameInput) {
                childNameInput.addEventListener('input', (e) => {
                    const isValid = validateInput(
                        e.target, 
                        'childName-error', 
                        value => value.trim().length >= 1,
                        '„ÅäÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ'
                    );
                    if (isValid) {
                        state.updateFormData('childName', e.target.value.trim());
                    }
                });
            }
            
            // Age validation
            const childAgeSelect = document.getElementById('childAge');
            if (childAgeSelect) {
                childAgeSelect.addEventListener('change', (e) => {
                    const isValid = validateInput(
                        e.target,
                        'childAge-error',
                        value => value !== '',
                        'Âπ¥ÈΩ¢„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ'
                    );
                    if (isValid) {
                        state.updateFormData('childAge', e.target.value);
                    }
                });
            }
            
            // Budget validation
            const budgetSelect = document.getElementById('budget');
            if (budgetSelect) {
                budgetSelect.addEventListener('change', (e) => {
                    const isValid = validateInput(
                        e.target,
                        'budget-error',
                        value => value !== '',
                        '‰∫àÁÆó„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ'
                    );
                    if (isValid) {
                        state.updateFormData('budget', e.target.value);
                    }
                });
            }
            
            // Gender (optional)
            const genderSelect = document.getElementById('gender');
            if (genderSelect) {
                genderSelect.addEventListener('change', (e) => {
                    state.updateFormData('gender', e.target.value);
                });
            }
            
            // Personality radio buttons
            document.querySelectorAll('input[name="personality"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        state.updateFormData('personality', e.target.value);
                    }
                });
            });
            
            // Interests checkboxes
            document.querySelectorAll('input[name="interests"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    const selectedInterests = Array.from(document.querySelectorAll('input[name="interests"]:checked'))
                        .map(cb => cb.value);
                    state.updateFormData('interests', selectedInterests);
                });
            });
            
            // Activity level radio buttons
            document.querySelectorAll('input[name="activityLevel"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        state.updateFormData('activityLevel', e.target.value);
                    }
                });
            });
            
            // Transportation radio buttons
            document.querySelectorAll('input[name="transportation"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        state.updateFormData('transportation', e.target.value);
                    }
                });
            });
            
            // Time slots checkboxes
            document.querySelectorAll('input[name="timeSlots"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    const selectedTimeSlots = Array.from(document.querySelectorAll('input[name="timeSlots"]:checked'))
                        .map(cb => cb.value);
                    state.updateFormData('timeSlots', selectedTimeSlots);
                });
            });
            
            // Goals checkboxes
            document.querySelectorAll('input[name="goals"]').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    const selectedGoals = Array.from(document.querySelectorAll('input[name="goals"]:checked'))
                        .map(cb => cb.value);
                    state.updateFormData('goals', selectedGoals);
                });
            });
        }
        
        // ============================================
        // Navigation & Main Functions
        // ============================================
        
        function nextStep() {
            if (state.currentStep < state.maxSteps) {
                UIManager.showStep(state.currentStep + 1);
            }
        }
        
        function previousStep() {
            if (state.currentStep > 1) {
                UIManager.showStep(state.currentStep - 1);
            }
        }
        
        function startDiagnosis() {
            UIManager.showStep(1);
        }
        
        function submitDiagnosis() {
            if (state.validateCurrentStep()) {
                UIManager.showLoading();
            }
        }
        
        function restartDiagnosis() {
            state.formData = {};
            state.results = null;
            state.saveToStorage();
            
            // Reset form elements
            document.querySelectorAll('input, select').forEach(element => {
                if (element.type === 'checkbox' || element.type === 'radio') {
                    element.checked = false;
                } else {
                    element.value = '';
                }
                element.classList.remove('error');
            });
            
            // Hide error messages
            document.querySelectorAll('.error-message').forEach(error => {
                error.style.display = 'none';
            });
            
            UIManager.showWelcome();
        }
        
        // ============================================
        // Share & Social Functions
        // ============================================
        
        function shareToTwitter() {
            const result = state.results;
            if (!result) return;
            
            const topActivity = result.recommendations[0];
            const url = window.location.href;
            
            const tweetText = `Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠„ÅÆÁµêÊûú„ÄÅ${result.formData.childName}„Åï„Çì„Å´„ÅØ„Äå${topActivity.activity.name}„Äç„Åå„Åä„Åô„Åô„ÇÅÔºÅ${topActivity.activity.icon} 

ÈÅ©ÊÄßÂ∫¶: ${topActivity.compatibility.text}
ÊÄßÊ†º„Çø„Ç§„Éó: ${result.personalityType.name}

„ÅÇ„Å™„Åü„ÅÆ„ÅäÂ≠êÊßò„Å´„ÅØ„Å©„Çì„Å™Áøí„ÅÑ‰∫ã„ÅåÂêë„ÅÑ„Å¶„ÅÑ„Çã„Åã„Å™Ôºü

#Á∂ôÁ∂ö„ÅØÂäõ„Å™„Çä #Áøí„ÅÑ‰∫ãË®∫Êñ≠ #Â≠êËÇ≤„Å¶ #ÊïôËÇ≤ #ÁÑ°ÊñôË®∫Êñ≠

${url}`;
            
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
            window.open(twitterUrl, '_blank', 'width=600,height=400');
            closeShareModal();
        }
        
        function copyToClipboard() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('URL„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ');
                closeShareModal();
            }).catch(err => {
                console.error('Failed to copy:', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('URL„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ');
                closeShareModal();
            });
        }
        
        function shareActivity(activityKey) {
            const activity = AppConfig.activities[activityKey];
            if (!activity) return;
            
            const url = window.location.href;
            const tweetText = `„Äå${activity.name}„Äç„ÅåÊ∞ó„Å´„Å™„ÇãÔºÅ${activity.icon}

${activity.description}

Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠„ÅßË©≥„Åó„Åè„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶„Åø„Çà„ÅÜ‚ú®

#Á∂ôÁ∂ö„ÅØÂäõ„Å™„Çä #Áøí„ÅÑ‰∫ã #${activity.category} #Â≠êËÇ≤„Å¶

${url}`;
            
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
            window.open(twitterUrl, '_blank', 'width=600,height=400');
        }
        
        function openShareModal() {
            document.getElementById('shareModal').style.display = 'flex';
        }
        
        function closeShareModal() {
            document.getElementById('shareModal').style.display = 'none';
        }
        
        function printResults() {
            window.print();
        }
        
        // ============================================
        // History & Storage Functions
        // ============================================
        
        function showHistory() {
            if (state.history.length === 0) {
                alert('Ë®∫Êñ≠Â±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ');
                return;
            }
            
            const historyHtml = state.history.map((result, index) => `
                <div class="border-b pb-4 mb-4">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium">${result.formData.childName || 'ÂêçÁÑ°„Åó'}„Åï„Çì„ÅÆË®∫Êñ≠ÁµêÊûú</h4>
                            <p class="text-sm text-gray-600">${new Date(result.timestamp).toLocaleDateString('ja-JP')}</p>
                            <p class="text-sm">1‰Ωç: ${result.recommendations[0].activity.name}</p>
                        </div>
                        <button onclick="loadHistoryResult(${index})" class="btn btn-primary text-sm">
                            Ë©≥Á¥∞„ÇíË¶ã„Çã
                        </button>
                    </div>
                </div>
            `).join('');
            
            const modalHtml = `
                <div id="historyModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <div class="bg-white rounded-xl p-6 m-4 max-w-2xl w-full max-h-96 overflow-y-auto">
                        <h3 class="text-lg font-semibold mb-4">Ë®∫Êñ≠Â±•Ê≠¥</h3>
                        <div class="space-y-4">
                            ${historyHtml}
                        </div>
                        <button onclick="closeHistoryModal()" class="btn btn-secondary w-full mt-4">
                            Èñâ„Åò„Çã
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }
        
        function loadHistoryResult(index) {
            const result = state.history[index];
            if (!result) return;
            
            state.results = result;
            state.formData = result.formData;
            
            closeHistoryModal();
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('stepContainer').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';
            document.getElementById('progressContainer').style.display = 'none';
            
            UIManager.renderResults(result);
        }
        
        function closeHistoryModal() {
            const modal = document.getElementById('historyModal');
            if (modal) {
                modal.remove();
            }
        }
        
        function compareWithFriends() {
            const result = state.results;
            if (!result) return;
            
            const shareText = `ÂèãÈÅî„Å®ÊØîËºÉÔºÅ${result.formData.childName}„Åï„Çì„ÅÆË®∫Êñ≠ÁµêÊûú:

üèÜ 1‰Ωç: ${result.recommendations[0].activity.name} (${result.recommendations[0].compatibility.text})
ü•à 2‰Ωç: ${result.recommendations[1].activity.name} (${result.recommendations[1].compatibility.text})  
ü•â 3‰Ωç: ${result.recommendations[2].activity.name} (${result.recommendations[2].compatibility.text})

ÊÄßÊ†º„Çø„Ç§„Éó: ${result.personalityType.name}

„Åø„Çì„Å™„ÅÆÁµêÊûú„ÅØ„Å©„ÅÜ„Åã„Å™Ôºü

#Á∂ôÁ∂ö„ÅØÂäõ„Å™„Çä #Áøí„ÅÑ‰∫ãË®∫Êñ≠ #ÂèãÈÅî„Å®ÊØîËºÉ

${window.location.href}`;
            
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}`;
            window.open(twitterUrl, '_blank', 'width=600,height=400');
        }
        
        function saveCurrentResult() {
            if (state.results) {
                state.saveResult(state.results);
                alert('Ë®∫Êñ≠ÁµêÊûú„Çí‰øùÂ≠ò„Åó„Åæ„Åó„ÅüÔºÅ');
            }
        }
        
        // ============================================
        // PWA & Service Worker
        // ============================================
        
        function initServiceWorker() {
            if ('serviceWorker' in navigator) {
                const swCode = `
                    const CACHE_NAME = 'kids-activity-finder-v1';
                    const urlsToCache = [
                        '/',
                        '/index.html'
                    ];
                    
                    self.addEventListener('install', event => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then(cache => cache.addAll(urlsToCache))
                        );
                    });
                    
                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            caches.match(event.request)
                                .then(response => response || fetch(event.request))
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then(() => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed'));
            }
        }
        
        // ============================================
        // Initialization
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize UI
            UIManager.showWelcome();
            
            // Setup form validation
            setupValidation();
            
            // Setup event listeners
            document.getElementById('startBtn')?.addEventListener('click', startDiagnosis);
            document.getElementById('step1Next')?.addEventListener('click', nextStep);
            document.getElementById('step2Next')?.addEventListener('click', nextStep);
            document.getElementById('step3Next')?.addEventListener('click', nextStep);
            document.getElementById('step4Next')?.addEventListener('click', nextStep);
            document.getElementById('step5Next')?.addEventListener('click', nextStep);
            document.getElementById('step6Submit')?.addEventListener('click', submitDiagnosis);
            
            document.getElementById('step2Back')?.addEventListener('click', previousStep);
            document.getElementById('step3Back')?.addEventListener('click', previousStep);
            document.getElementById('step4Back')?.addEventListener('click', previousStep);
            document.getElementById('step5Back')?.addEventListener('click', previousStep);
            document.getElementById('step6Back')?.addEventListener('click', previousStep);
            
            document.getElementById('shareBtn')?.addEventListener('click', openShareModal);
            document.getElementById('printBtn')?.addEventListener('click', printResults);
            document.getElementById('newDiagnosisBtn')?.addEventListener('click', restartDiagnosis);
            document.getElementById('compareBtn')?.addEventListener('click', compareWithFriends);
            document.getElementById('saveResultBtn')?.addEventListener('click', saveCurrentResult);
            document.getElementById('historyBtn')?.addEventListener('click', showHistory);
            
            // Close modal when clicking outside
            document.getElementById('shareModal')?.addEventListener('click', (e) => {
                if (e.target.id === 'shareModal') {
                    closeShareModal();
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeShareModal();
                    closeHistoryModal();
                }
            });
            
            // Initialize PWA
            initServiceWorker();
            
            // Add install prompt for PWA
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                
                // Show install button if not already installed
                if (!window.matchMedia('(display-mode: standalone)').matches) {
                    const installBtn = document.createElement('button');
                    installBtn.textContent = '„Ç¢„Éó„É™„Å®„Åó„Å¶„Ç§„É≥„Çπ„Éà„Éº„É´';
                    installBtn.className = 'btn btn-secondary text-sm';
                    installBtn.onclick = () => {
                        deferredPrompt.prompt();
                        deferredPrompt.userChoice.then((choiceResult) => {
                            if (choiceResult.outcome === 'accepted') {
                                console.log('User accepted the install prompt');
                            }
                            deferredPrompt = null;
                            installBtn.remove();
                        });
                    };
                    
                    document.querySelector('header .flex').appendChild(installBtn);
                }
            });
            
            console.log('üéØ Â≠ê‰æõ„ÅÆÁøí„ÅÑ‰∫ãË®∫Êñ≠ Pro „ÅåÂàùÊúüÂåñ„Åï„Çå„Åæ„Åó„Åü');
        });
        
        // ============================================
        // Utility Functions
        // ============================================
        
        // Debounce function for performance
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('ja-JP', {
                style: 'currency',
                currency: 'JPY'
            }).format(amount);
        }
        
        // Error boundary
        window.addEventListener('error', (e) => {
            console.error('Application error:', e.error);
            // In a real app, you might want to send this to a logging service
        });
        
        // Performance monitoring
        window.addEventListener('load', () => {
            if ('performance' in window) {
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                console.log(`üöÄ Page loaded in ${loadTime}ms`);
            }
        });
    </script>
</body>
</html>
